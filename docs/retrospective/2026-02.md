# 2026년 2월 회고

## 변경 이력

### 2026-02-12 — PR #50: feat: 404, 403, 500 에러 페이지 구현

#### 변경 요약

- 변경 파일 10개, +735 / -7
- ErrorPage 공통 컴포넌트, Storybook 스토리, Unit 테스트 신규 추가
- TanStack Router errorComponent/notFoundComponent 통합 및 다국어(i18n) 리소스 추가

#### ✅ 잘한 점 (Keep)

- 병렬 실행으로 컴포넌트/테스트/스토리 작업을 분리해 효율적으로 진행
- 접근성(role="alert", aria-label)과 다크 모드까지 포함한 범용 컴포넌트 설계
- tech-architect 검증 점수 반영으로 스타일/타입 안정성 정리

#### 🔧 개선점 (Improve)

- named export vs default import 불일치로 통합 시점에 수정 발생
- Storybook args 타입 누락과 notFound 변경으로 기존 테스트 실패
- pre-commit 훅(tsc + vitest)에서 3회 실패로 수정 반복
- 권한 제약으로 pnpm 실행을 git-guardian에 의존

#### 🤖 에이전트 개선 제안 (Try)

- **feature-developer**: export 형태(default/named)를 작업 요약에 명시하고 공유
  - 파일: `.agents/agents/feature-developer.md`
  - 추가 규칙: 컴포넌트 공개 API(export 형태, props 필수값) 표준 템플릿 작성
- **test-specialist**: Storybook 스토리 작성 시 required args 체크리스트 추가
  - 파일: `.agents/agents/test-specialist.md`
  - 추가 규칙: 모든 스토리에 대해 args 타입 검증(필수/옵션) 확인
- **master-orchestrator**: 권한 제약 사전 고지 및 검증 위임 타이밍 명시
  - 파일: `.agents/agents/master-orchestrator.md`
  - 추가 규칙: pnpm 미보유 작업은 git-guardian 또는 lint-formatter에 위임 타이밍 명시
- **git-guardian**: pre-commit 실패 원인 유형(타입/테스트/스토리) 분류 기록
  - 파일: `.agents/agents/git-guardian.md`
  - 추가 규칙: 실패 2회 이상 시 원인 분류와 대응 조치 기록

### 2026-02-12 — PR #46: refactor: 기술부채 개선 — 타입 안전성, i18n, 파일명 규칙, UI 개선

#### 변경 요약

- 변경 파일 25개, +239 / -55
- `parseLocale()` 도입으로 locale 캐스팅 제거 및 타입 안전성 향상
- MDComponent 에러/로딩 UI 개선 + i18n 적용
- PostCardListSkeleton 추가 및 Suspense fallback 개선
- i18n 리소스/스키마에 post·markdown 키 추가 (ko/en/ja)
- Footer 연도 동적 처리, 파일명 kebab-case 정리
- opencode.json 읽기 명령어 권한 패턴 개선 포함

#### ✅ 잘한 점 (Keep)

- **타입 안전성 강화**: `as LocaleType` 제거 후 `parseLocale()` 도입으로 런타임 안전성 확보
- **i18n 일관성 확장**: UI 텍스트 번역 키를 스키마와 리소스에 동기화하여 언어 간 누락 방지
- **UX 개선 동시 달성**: MDX 에러/로딩 상태에 재시도 동작과 시각적 피드백 추가
- **테스트 신뢰성 유지**: 테스트 206/206 통과 및 실패 요인을 테스트 코드에서 즉시 보정

#### 🔧 개선점 (Problem)

- **테스트 실패 10건 발생**: feature 변경 후 테스트 모킹/하드코딩 값 업데이트가 지연됨
- **worktree 규칙 위반**: test-specialist가 메인 디렉토리 수정 → 복구 작업 필요
- **설정 변경 잔류**: opencode.json 변경이 세션 잔류분으로 PR에 포함되어 관심사 혼재
- **권한 제약 전가**: master-orchestrator의 제한된 git 권한으로 git-guardian 의존도가 증가

#### 🤖 에이전트 개선 제안 (Try)

- **feature-developer**: 변경 전 “테스트 영향 체크리스트” 추가
  - 파일: `.agents/agents/feature-developer.md`
  - 추가 규칙: i18n 키/문구 수정, UI 텍스트, 파일명 변경 시 관련 테스트(mock, snapshot, 문자열 하드코딩) 목록 작성 후 공유
- **test-specialist**: worktree 경로 확인 절차 의무화
  - 파일: `.agents/agents/test-specialist.md`
  - 추가 규칙: 작업 시작 전 `git worktree list`로 현재 경로 확인, 메인 디렉토리에서의 수정 금지 문구 강화
- **git-guardian**: 잔류 설정 변경 탐지 체크 추가
  - 파일: `.agents/agents/git-guardian.md`
  - 추가 규칙: PR 포함 파일 중 opencode.json이 있으면 “의도된 변경인지” 확인하고 별도 커밋 분리 권고
- **master-orchestrator**: 권한 제한 이슈 상시 공유 문구 추가
  - 파일: `.agents/agents/master-orchestrator.md`
  - 추가 규칙: 작업 시작 시 필요 git 명령 권한을 사전 점검하고 git-guardian 위임 타이밍 명시

#### 워크플로우 개선 제안

- **Worktree 경로 고정 규칙**: 작업 시작 시 worktree 경로를 PR 본문에 기록 → 디렉토리 혼용 방지
- **변경 영향 공유 템플릿**: feature-developer가 “변경 영향 요약(테스트/문서/i18n/파일명)”을 PR 본문에 추가
- **설정 변경 분리 원칙**: opencode.json 등 설정 변경은 별도 커밋/PR로 분리하여 리뷰 부담 감소
- **권한 위임 기준 표준화**: git-guardian에게 위임해야 하는 명령을 체크리스트로 운영

### 2026-02-11 — PR #40: 문서 구조 개편 - agents.md 분리 및 에이전트 프롬프트 최적화

#### 변경 요약

- 21개 파일 변경 (+1,236 / -1,329)
- `docs/agents.md` (955줄) → 허브 문서(140줄) + 9개 상세 문서 분리 (85% 축소)
- `.agents/agents/` 8개 에이전트 프롬프트 최적화 (1,545줄 → 1,235줄, 20% 감소)
- `opencode.json` 권한 설정 동기화

#### ✅ 잘한 점 (Keep)

- **체계적 Phase 분리**: 3단계 (문서 분리 → 프롬프트 최적화 → 일관성 검증)로 리스크 최소화
- **내용 무손실 분리**: 955줄 거대 문서를 9개 문서로 분리하면서 내용 100% 보존
- **프론트매터 보존**: 에이전트 프롬프트 최적화 시 YAML frontmatter 100% 유지 (동작 영향 없음)
- **상호 참조 체계**: 각 분리 문서에 `> 이 문서의 상위 문서: [agents.md](./agents.md)` 네비게이션 추가
- **검증 루프**: 각 Phase마다 tech-architect 검증 수행, Phase 3에서 doc-manager 교차 검증
- **중복 제거 원칙 일관 적용**: 에이전트 프롬프트에서 `docs/`와 중복되는 규칙을 참조(`→ 상세: docs/*.md`)로 교체

#### 🔧 개선점 (Problem)

- **커밋 중복**: 7개 커밋 중 동일 제목 커밋 존재 (commit 1과 3: `docs(agents): 문서 구조 개편 - 허브 문서 + 9개 상세 문서 분리`, commit 6과 7: `docs: 일관성 검증 개선 - 참조 누락 수정 및 구체화`). Phase별 squash 또는 명확한 커밋 구분 필요
- **opencode.json 변경 범위**: 문서 구조 개편 PR에 opencode.json 권한 설정까지 포함 (+182/-73). 관심사 분리가 아쉬움 — 별도 커밋 또는 PR로 분리하는 것이 리뷰 부담 감소
- **agents.md 최종 크기 불일치**: 커밋 메시지에 "~200줄"이라 했으나 실제 최종 크기는 약 140줄. 커밋 메시지의 정확성 개선 필요
- **PR 상태**: 아직 OPEN 상태 — 리뷰/머지 프로세스 진행 필요

#### 🤖 에이전트 개선 제안 (Try)

- **git-guardian**: 동일 제목 커밋 감지 로직 추가. `git log --oneline` 결과에서 중복 제목 발견 시 경고 및 squash 제안
  - 파일: `.agents/agents/git-guardian.md`
  - 추가 규칙: "커밋 생성 전 최근 5개 커밋과 제목 중복 여부 확인. 중복 시 `--amend` 또는 구체적 제목 사용 권장"
- **doc-manager**: 문서 분리 작업 시 "커밋 메시지 내 수치와 실제 파일 줄 수 일치 여부" 검증 체크리스트 추가
  - 파일: `.agents/agents/doc-manager.md`
- **master-orchestrator**: 대규모 설정 파일(opencode.json) 변경은 문서/코드 변경과 별도 커밋으로 분리하는 규칙 추가
  - 파일: `.agents/agents/master-orchestrator.md`

#### 워크플로우 효율성 평가

- **Git Flow 준수**: ✅ `develop → feature branch → worktrees` 정상 운용
- **에이전트 분업**: ✅ doc-manager(문서 작성) + tech-architect(검증) 역할 분리 적절
- **병렬 작업**: ⚠️ 이번 PR은 문서 전용이라 병렬 필요성 낮았으나, Phase 1~2는 독립적이므로 병렬 실행 가능했음
- **전체 소요 시간**: 7개 커밋, 약 30분 내 완료 — 문서 전용 작업치고 효율적

### 2026-02-11 (이전)

- 에이전트 권한 체계 전면 정비 (opencode.json + 문서 12개 동기화)
  - git add: git-guardian 전용으로 통합 (다른 에이전트에서 제거)
  - pnpm test/lint/tsc/fmt: 전문 에이전트만 보유 (orchestrator/git-guardian/github-helper에서 제거)
  - mkdir docs/\*: master-orchestrator → doc-manager 이관
  - lint-formatter edit에 기본 deny 추가
  - global permission에서 git add 관련 5개 항목 삭제
  - 권한 매트릭스 및 에이전트 프롬프트 전면 재검증

### 2026-02-08

- Next.js 16에서 TanStack Router v1 + Vite v7로 마이그레이션 완료
- 멀티 에이전트 시스템 활용 (Master Orchestrator + 6 Subagents)
- 빌드 성능 60% 개선, HMR 95% 개선, 번들 크기 25% 감소
- `@mdx-js/mdx`로 런타임 MDX 렌더링 전환 (`compile()` + `new Function()`)
- Git Worktree 기반 병렬 작업 전략 도입
