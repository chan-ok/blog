# 2026년 2월 회고

## 변경 이력

### 2026-02-16 — PR #63: feat: 홈 화면 최근 포스트 레이아웃 개선

#### 변경 요약

- **PR 유형**: feature → develop (기능 개선)
- **변경 파일**: 3개, +509 / -26
  - `src/2-features/post/ui/post-compact-card.tsx` (신규 64줄)
  - `src/2-features/post/ui/post-compact-card.test.tsx` (신규 432줄)
  - `src/2-features/post/ui/recent-post-block.tsx` (수정 +13/-26)
- **주요 변경**:
  - PostCompactCard 컴포넌트 신규 생성 (썸네일 포함 컴팩트 카드)
  - RecentPostBlock을 반응형 그리드 레이아웃으로 변경 (모바일 1열, 데스크톱 3열)
  - 카드 높이 조정 (최종: h-72/md:h-80, 썸네일 h-40/md:h-32)
  - 기본 썸네일 경로: `/image/context.png`
- **커밋 수**: 14개 (요구사항 변경 3회 반복으로 증가)
- **테스트**: PostCompactCard 테스트 15개 (unit 13개 + property-based 2개) 추가

#### 변경 배경

**사용자 요구사항**: 홈 화면 최근 포스트 섹션의 레이아웃 개선

**요구사항 변경 히스토리**:
1. **1차 요구사항** (49200de): 모든 카드를 PostSimpleCard로 통일, 데스크톱 3열 그리드
2. **2차 요구사항** (acb8318): 썸네일 기능 추가, PostCompactCard 신규 생성, 모바일 상단/데스크톱 좌측 레이아웃
3. **3차 요구사항** (00fa815, e030fb1): 카드 높이 조정, 모든 디바이스 수직 레이아웃 적용

**기술적 배경**:
- 기존 `PostBasicCard`(첫 카드) + `PostSimpleCard`(나머지 카드) 조합 → `PostCompactCard` 단일 컴포넌트로 통일
- 반응형 그리드 레이아웃으로 다양한 디바이스 대응
- 썸네일 이미지로 시각적 임팩트 강화

#### ✅ 잘한 점 (Keep)

1. **테스트 커버리지 확보**
   - PostCompactCard 컴포넌트에 432줄의 포괄적 테스트 작성
   - 기본 렌더링, 접근성, 반응형, 상호작용(hover), 다크 모드 검증
   - Property-based 테스트 2개: 50가지 입력 조합 + 30가지 날짜 포맷
   - 커버리지: 100% (15개 테스트 모두 통과)

2. **반응형 디자인 완성도**
   - 모바일 1열 → 데스크톱 3열 그리드 레이아웃
   - 카드 높이 비율 조정 (h-72/md:h-80, 썸네일 h-40/md:h-32)
   - 스켈레톤 컴포넌트도 동일한 높이 적용 (h-72/md:h-80)
   - Tailwind CSS 반응형 클래스로 일관된 스타일 관리

3. **재사용 가능한 컴포넌트 설계**
   - PostCompactCard를 `src/2-features/post/ui/` 경로에 배치 (FSD features 레이어)
   - 다른 위젯(최신 포스트, 인기 포스트 등)에서도 재사용 가능
   - Props 인터페이스가 명확하여 확장 용이 (`Frontmatter` 타입 활용)

4. **다크 모드 지원**
   - 컴포넌트 설계 단계부터 다크 모드 스타일 포함
   - `dark:bg-gray-800`, `dark:border-zinc-800` 등 클래스 적용
   - 테스트 코드에서 다크 모드 검증 포함

5. **접근성 고려**
   - `<article>` 시맨틱 태그 사용
   - `<time>` 태그로 날짜 마크업
   - `alt` 텍스트 제공 (썸네일 이미지)
   - 키보드 네비게이션 지원 (Button + Link 조합)

6. **엣지 케이스 처리**
   - 썸네일이 없을 경우 기본 이미지 사용 (`/image/context.png`)
   - 날짜 유효성 검사 (`isValid(createdAt)`) 후 "Invalid Date" 표시
   - lazy loading으로 이미지 로딩 최적화

#### 🔧 개선점 (Problem)

1. **요구사항 변경 3회 반복 → 불필요한 커밋 증가 (10개 커밋)**
   - **히스토리**:
     - 1차 (49200de): PostSimpleCard 사용, 3열 그리드
     - 2차 (acb8318): PostCompactCard 추가, 썸네일 기능
     - 3차 (00fa815, e030fb1): 카드 높이 조정 (h-40/h-36 → h-72, 썸네일 h-48 → h-32 → h-40)
   - **원인**: 사용자가 최종 레이아웃을 미리 확정하지 않고 점진적 피드백
   - **영향**: 커밋 히스토리 가독성 저하, 작업 효율성 감소

2. **테스트 코드 반복 수정 (2회)**
   - test-specialist가 PostCompactCard 높이 변경에 따라 테스트 코드를 2회 재작성
     - 1차 (a32b1d0): h-40/h-36 검증
     - 2차 (0523eca): h-72/h-96 검증
   - **원인**: feature-developer의 UI 크기 조정이 테스트 코드에 직접 영향
   - **영향**: test-specialist의 불필요한 재작업 발생

3. **Phase 1 통합 실패 → 재작업 필요**
   - 첫 번째 Phase에서 feature-developer와 test-specialist 통합 시 테스트 파일 누락
   - 머지 커밋 (d8d4f97, 55af9cd): RecentPostBlock 테스트가 누락된 상태로 통합
   - **원인**: master-orchestrator가 Phase 통합 전 파일 리스트를 충분히 검증하지 않음
   - **영향**: 추가 Phase 작업 필요, 작업 일정 지연

4. **중복 커밋 잔류 (3회 연속)**
   - 동일한 제목의 `refactor: PostCompactCard 레이아웃 개선` 커밋이 3회 연속 발생
     - 00fa815, 36cdb5b, 4d5ef99 (커밋 해시만 다르고 제목/내용 동일)
   - **원인**: git-guardian이 squash를 실행하지 않고 중복 커밋을 그대로 푸시
   - **영향**: 커밋 히스토리 가독성 저하, PR 리뷰 시 혼란

5. **worktree 머지 커밋 메시지 일관성 부족**
   - 초기 머지 커밋 (d8d4f97, 55af9cd): `merge(phase1): ...`
   - 후기 머지 커밋 (33a2472): `merge(phase1): ... (PostCompactCard 추가)`
   - 최종 머지 커밋 (486377460, 489e5ce): `merge(worktree): ...`, `merge(test): ...`
   - **원인**: 머지 커밋 메시지 규칙이 명확하지 않음
   - **영향**: 커밋 히스토리 추적 어려움

#### 🤖 에이전트 개선 제안 (Try)

1. **master-orchestrator**: 요구사항 최종 확정 후 작업 시작 규칙 추가
   - **파일**: `.agents/agents/master-orchestrator.md`
   - **추가 규칙**:
     - UI/레이아웃 변경 작업 시 사용자에게 최종 스펙 확인 질문 (카드 높이, 썸네일 크기, 그리드 열 수, 반응형 브레이크포인트)
     - 사용자가 "일단 진행 후 보고 수정" 답변 시 → "작업 효율을 위해 최종 스펙 확정 권장" 안내
     - Phase 시작 전 요구사항 체크리스트 검증

2. **feature-developer**: UI 크기 조정 시 테스트 영향 범위 사전 고지
   - **파일**: `.agents/agents/feature-developer.md`
   - **추가 규칙**:
     - 컴포넌트 크기(height, width), 레이아웃(flex, grid) 변경 시 "test-specialist가 테스트 코드 업데이트 필요" 명시
     - worktree 통합 전 변경사항 요약에 "테스트 영향 범위" 항목 추가
     - 예시: "PostCompactCard 높이 h-40 → h-72 변경 → test-specialist가 height 검증 테스트 수정 필요"

3. **git-guardian**: 동일 커밋 메시지 연속 3회 감지 시 squash 경고 강화
   - **파일**: `.agents/agents/git-guardian.md`
   - **추가 규칙**:
     - `git log --oneline | head -10`으로 최근 커밋 메시지 중복 검사
     - 동일 prefix + 동일 주제 패턴 감지 (예: `refactor: PostCompactCard 레이아웃 개선`)
     - 연속 3회 이상 중복 시 자동 squash 제안 (예: `git rebase -i HEAD~3`)
     - squash 실행 후 커밋 메시지에 변경 이력 요약 포함

4. **test-specialist**: 컴포넌트 크기 검증을 하드코딩 대신 변수화 권장
   - **파일**: `.agents/agents/test-specialist.md`
   - **추가 규칙**:
     - UI 크기 검증 시 하드코딩(expect(element).toHaveClass('h-72')) 대신 변수 사용
     - 예시:
       ```typescript
       const EXPECTED_CARD_HEIGHT = { mobile: 'h-72', desktop: 'md:h-80' };
       expect(card).toHaveClass(EXPECTED_CARD_HEIGHT.mobile);
       ```
     - feature-developer가 크기 변경 시 변수만 수정하면 테스트 전체 업데이트
     - Property-based 테스트에서 크기 관련 값도 변수화

5. **git-guardian**: worktree 머지 커밋 메시지 규칙 명시
   - **파일**: `.agents/agents/git-guardian.md`
   - **추가 규칙**:
     - 형식: `merge(worktree): [에이전트명] 작업 통합 - [핵심 변경사항]`
     - 예시: `merge(worktree): feature-developer 작업 통합 - PostCompactCard 컴포넌트 추가`
     - Phase 번호는 사용하지 않음 (Phase는 master-orchestrator 내부 추상화)

#### 관련 커밋

- **초기 레이아웃 변경**: 49200de (PostSimpleCard 통일)
- **테스트 추가**: 672d4e8 (RecentPostBlock 테스트)
- **Phase 1 통합**: d8d4f97 (feature-dev), 55af9cd (test-spec)
- **PostCompactCard 추가**: acb8318 (컴포넌트), a32b1d0 (테스트)
- **Phase 2 통합**: 33a2472
- **레이아웃 개선 (3회 반복)**: 00fa815, 36cdb5b, 4d5ef99
- **최종 높이 조정**: e030fb1 (h-72/h-96), 0523eca (테스트 업데이트)
- **최종 통합**: 486377460 (feature-dev), 489e5ce (test-spec)

#### 개선 효과 예측

- **요구사항 확정 규칙**: 커밋 수 10개 → 6개로 40% 감소
- **크기 검증 변수화**: 테스트 수정 시간 2회 → 1회로 50% 감소
- **squash 자동화**: 중복 커밋 3개 → 1개로 66% 감소
- **머지 메시지 규칙**: 커밋 히스토리 가독성 향상

#### 교훈 (Lessons Learned)

1. **UI 작업은 최종 스펙 확정 후 시작**: 점진적 피드백보다 사전 확정이 효율적
2. **테스트 코드는 변경에 유연하게 대응**: 하드코딩보다 변수화가 유지보수성 향상
3. **커밋 히스토리는 프로젝트의 설명서**: 중복 커밋은 가독성을 크게 해침
4. **Phase 통합 전 파일 리스트 검증**: 누락된 파일이 없는지 체크리스트 확인 필요
5. **에이전트 간 영향 범위 명시**: feature-developer의 변경이 test-specialist에 미치는 영향을 사전 고지

### 2026-02-15 — PR #61: release: 블로그 썸네일 기능 및 Markdown 렌더링 개선

#### 변경 요약

- **PR 유형**: develop → main 릴리스 (72개 커밋 통합)
- **변경 파일**: 96개, +10,719 / -2,108
- **주요 기능**:
  - 블로그 리스트 썸네일 자동 표시 기능
  - Markdown 콜아웃/이미지 렌더링 수정
  - 404/403/500 에러 페이지 구현
  - 기술부채 정리 (타입 안전성, i18n, 파일명 규칙)
  - 문서 구조 개편 (agents.md 분리)
- **테스트**: 32개 테스트 파일 변경 (신규/수정 포함)
- **의존성**: 17개 패키지 업데이트 (axios 1.13.4→1.13.5 보안 패치 포함)
- **회고/문서**: TODO 4개 문서 추가, 회고 문서 업데이트

#### ✅ 잘한 점 (Keep)

- **안정적 릴리스 프로세스**:
  - 72개 커밋을 develop 브랜치에서 테스트 완료 후 main으로 통합
  - 모든 테스트 통과 상태(423개 unit + E2E) 확인 후 머지
  - Netlify 배포 자동화로 프로덕션 배포 안정성 확보

- **테스트 커버리지 대폭 향상**:
  - 32개 테스트 파일 변경 (blockquote, image-block, remark-plugin, ErrorPage 등)
  - Property-based 테스트로 Markdown 렌더링 엣지 케이스 검증
  - Storybook 스토리 추가로 UI 컴포넌트 시각적 검증 강화

- **Git 워크플로우 개선**:
  - husky pre-commit 훅에 `pnpm audit fix` 자동화
  - pre-push 스크립트 shebang 추가로 실행 환경 안정화
  - `dependency-audit.sh` 스크립트 네트워크 에러 graceful failure 처리

- **에이전트 시스템 정교화**:
  - security-scanner 에이전트를 tech-architect에 통합하여 역할 중복 제거
  - opencode.json 권한 설정 최적화 (e2e 디렉토리 write/edit 허용, worktree 제거 권한)
  - 에이전트 프롬프트 읽기 명령어 패턴 개선

- **문서화 강화**:
  - TODO 문서 4개 추가 (MDX 통합, 코드 정리, SEO, 테스트)
  - 회고 문서(overview.md, 2026-02.md) 실시간 업데이트
  - 진행 상황 추적으로 프로젝트 히스토리 명확화

- **썸네일 기능 구현**:
  - 블로그 리스트에 썸네일 이미지 자동 표시
  - frontmatter `thumbnail` 필드 지원
  - 반응형 디자인 및 다크 모드 지원

#### 🔧 개선점 (Problem)

- **husky 스크립트 안정화 반복 (7회)**:
  1. `fix(husky): restore PATH setup in pre-push script`
  2. `fix(husky): add shebang to pre-commit and pre-push scripts`
  3. `fix(husky): remove PATH setup from pre-push script`
  4. `fix(husky): remove optional build check from pre-push script`
  5. `fix(dependency-audit): handle audit command failure gracefully`
  6. `fix(husky): remove pre-push script`
  7. `fix(audit): add audit fix command to pre-commit hook and remove dependency audit script`
  - **원인**: husky 스크립트 동작을 사전에 충분히 검증하지 않고 커밋 후 문제 발견
  - **영향**: 커밋 히스토리 가독성 저하, pre-push 훅 최종적으로 제거됨

- **pnpm audit 실패 처리 미흡**:
  - 초기에는 네트워크 에러 시 훅이 멈춤
  - `set +e`로 에러 무시 후 exit 0 처리로 해결
  - **원인**: CI 환경에서 외부 API(npm registry) 의존성을 고려하지 않음

- **opencode.json 빈번한 변경 (10회 이상)**:
  - e2e 디렉토리 권한, worktree 제거 권한, 읽기 명령어 패턴 등
  - 여러 PR에 걸쳐 opencode.json 변경이 섞임
  - **원인**: 에이전트 권한 체계를 사전에 완전히 설계하지 않고 점진적으로 조정

- **디버깅 커밋 잔류 (5회)**:
  - 콜아웃/이미지 경로 디버깅 console.log 추가/제거 반복
  - `debug: 이미지·콜아웃 상세 디버깅 추가` 등
  - **원인**: 디버깅 커밋을 로컬에서만 사용하지 않고 원격에 푸시

- **lint-staged 설정 변경**:
  - `pnpm format`/`pnpm lint` → `prettier --write`/`eslint --fix`로 직접 명령어 사용
  - **원인**: pnpm 스크립트 호출 시 lint-staged의 파일 필터링이 작동하지 않는 문제

#### 🤖 에이전트 개선 제안 (Try)

- **git-guardian**: husky 스크립트 문법 및 동작 검증 체크리스트 추가
  - 파일: `.agents/agents/git-guardian.md`
  - 추가 규칙:
    - husky 스크립트 수정 시 shebang(`#!/usr/bin/env sh`) 필수
    - 외부 API 의존 명령어는 `set +e` + exit 0으로 graceful failure
    - 스크립트 수정 후 로컬에서 실제 훅 트리거하여 동작 검증
    - 연속 3회 이상 동일 파일(husky 스크립트) 수정 시 squash 경고

- **git-guardian**: 디버깅 커밋 squash 경고 강화
  - 파일: `.agents/agents/git-guardian.md`
  - 추가 규칙: 커밋 메시지에 "debug", "디버깅" 포함 시 "로컬 전용 커밋. 원격 푸시 전 squash 권장" 경고

- **master-orchestrator**: opencode.json 변경 분리 규칙 명시
  - 파일: `.agents/agents/master-orchestrator.md`
  - 추가 규칙: opencode.json 변경은 별도 커밋 또는 PR로 분리. 기능 PR에 opencode.json 변경 포함 금지

- **doc-manager**: 릴리스 PR에서 회고 자동 업데이트 규칙
  - 파일: `.agents/agents/doc-manager.md`
  - 추가 규칙: develop → main PR 생성 시 `docs/retrospective/overview.md`에 릴리스 회고 섹션 자동 추가

- **feature-developer**: lint-staged 명령어 수정 시 주의사항
  - 파일: `.agents/agents/feature-developer.md`
  - 추가 규칙: lint-staged에서 pnpm 스크립트 대신 직접 명령어 사용 (prettier/eslint 파일 필터링 유지)

#### 배운 점 (Lessons Learned)

1. **husky 스크립트 안정성**:
   - shebang 누락 시 일부 환경에서 실행 실패
   - PATH 설정은 husky 자체가 처리하므로 스크립트 내 불필요
   - 외부 API 의존 명령어(pnpm audit)는 graceful failure 필수

2. **lint-staged 파일 필터링**:
   - pnpm 스크립트 호출 시 lint-staged의 `$STAGED_FILES` 전달 안됨
   - prettier/eslint 직접 호출로 파일 필터링 유지

3. **릴리스 프로세스 체계화**:
   - develop → main PR은 단순 머지가 아닌 릴리스 단위
   - 회고 문서 업데이트, CHANGELOG 작성 등 릴리스 체크리스트 필요

4. **에이전트 역할 통합**:
   - security-scanner와 tech-architect 역할 중복 → 통합으로 프롬프트 토큰 절약
   - 에이전트 수를 늘리는 것보다 역할을 명확히 정의하는 것이 중요

5. **opencode.json 권한 설계**:
   - 점진적 조정보다는 사전에 권한 매트릭스 작성 후 일괄 설정이 효율적
   - 에이전트별 필요 권한을 체크리스트로 관리

#### 워크플로우 효율성 평가

- **Git Flow 준수**: ✅ `develop → main` 릴리스 프로세스 정상 운용
- **에이전트 분업**: ✅ feature-developer/test-specialist/doc-manager/git-guardian 역할 분리 명확
- **병렬 작업**: ✅ 여러 feature 브랜치를 develop에서 통합하는 워크플로우 안정적
- **커밋 품질**: ⚠️ husky 스크립트 수정 7회, 디버깅 커밋 5회 반복 → squash 필요
- **릴리스 규모**: 72개 커밋, 96개 파일, 약 2주 개발 기간 → 적정 릴리스 주기
- **전체 소요 시간**: develop 브랜치 2주 누적 → main 머지 10분 → 릴리스 프로세스 효율적

### 2026-02-15 — PR #60: feat: MDX 이미지 블록 및 콜아웃 기능 추가

#### 변경 요약

- 변경 파일 20개, +1,411 / -290
- Obsidian 스타일 이미지 문법(`![[images/path]]`) 지원 - remark 플러그인
- Notion 스타일 콜아웃 (INFO, WARNING, DANGER, SUCCESS) - blockquote 컴포넌트
- MDX 파싱 실패 시 댓글/TOC 숨김 처리
- HTML 시맨틱 오류 해결 (p > figure 중첩 제거)
- 테스트 코드 41개 추가 (blockquote 12개, image-block 17개, remark-obsidian-image 12개)
- Property-based 테스트 타임아웃 증가 (5s → 10s)

#### ✅ 잘한 점 (Keep)

- **TDD 프로세스 준수**: 테스트 먼저 작성(.skip) → 구현 → 활성화 순서로 진행하여 요구사항 명확화
- **Git Worktree 병렬 작업**: feature-dev와 test-spec 브랜치를 분리하여 기능 개발과 테스트 작성을 동시 진행
- **MDX 런타임 파싱 동작 학습**: remark/rehype 플러그인 체인을 직접 구현하며 MDX AST 변환 과정 이해
- **시맨틱 HTML 개선**: `<p><figure>` 중첩 제거를 위한 rehype-unwrap-images 플러그인 도입
- **사용자 경험 개선**: MDX 파싱 실패 시 댓글/TOC를 숨겨 깨진 UI 방지
- **종합 테스트 커버리지**: 423개 테스트 모두 통과, 새로운 기능에 대한 Unit + Property-based 테스트 완비

#### 🔧 개선점 (Problem)

- **반복된 버그 수정 (이미지 경로 해결 로직)**:
  - baseUrl + contentPath 조합 로직에서 슬래시 처리 오류 4회 반복 수정
  - 최종적으로 "이미지는 루트 images/ 디렉토리에 위치"한다는 가정으로 단순화
  - **원인**: 요구사항 미명확 (이미지 경로 규칙을 사전 정의하지 않음)
  
- **반복된 버그 수정 (콜아웃 파싱 로직 3회)**:
  1. `[!TYPE]` 태그가 본문에 노출됨 → children 첫 요소 제거 로직 추가
  2. 콜아웃 본문이 사라짐 → 첫 p 태그 전체를 제거했던 실수 수정
  3. MDX 개행 파싱 문제 → `[!TYPE] 제목\n본문`이 하나의 p 태그에 파싱되는 MDX 동작 발견 후 정규식 개선
  - **원인**: MDX가 마크다운 블록을 하나의 p 태그에 개행으로 구분하여 파싱하는 동작을 사전에 파악하지 못함

- **디버깅 커밋 잔류**: 디버깅 console.log를 여러 커밋에 추가 후 제거하는 과정이 커밋 히스토리에 남음 (5회)
  
- **Property-based 테스트 타임아웃**: PostDetailPage 테스트에서 mdxStatus 비동기 처리로 인한 타임아웃 발생
  
- **require vs ESM import**: remark 플러그인에서 `require('unist-util-visit')` 사용 후 브라우저 환경 오류 → ESM import로 수정

#### 🤖 에이전트 개선 제안 (Try)

- **feature-developer**: MDX/remark/rehype 플러그인 개발 체크리스트 추가
  - 파일: `.agents/agents/feature-developer.md`
  - 추가 규칙:
    - MDX 파싱 동작 사전 확인: 마크다운 블록이 어떻게 AST로 변환되는지 예제로 테스트
    - 플러그인 구현 전 unist-util-visit 문서 확인 및 ESM import 사용
    - 이미지 경로/링크 해결 로직 구현 시 프로젝트의 디렉토리 규칙을 먼저 명확히 정의
    - 디버깅 console.log는 별도 커밋으로 분리하지 말고 로컬에서만 사용
  
- **test-specialist**: Property-based 테스트 타임아웃 설정 가이드라인
  - 파일: `.agents/agents/test-specialist.md`
  - 추가 규칙:
    - Property-based 테스트에서 비동기 로직이 포함된 경우 타임아웃을 기본 5s → 10s로 증가
    - waitFor/findBy 사용 시 타임아웃을 명시적으로 설정
  
- **git-guardian**: 디버깅 커밋 감지 및 squash 권장
  - 파일: `.agents/agents/git-guardian.md`
  - 추가 규칙:
    - 커밋 메시지에 "debug", "디버깅"이 포함되거나 console.log 추가/제거만 있는 커밋은 squash 권장
    - 연속 3회 이상 동일 파일 수정 커밋 발견 시 "리팩토링 필요" 경고

- **master-orchestrator**: 복잡한 파싱 로직 요구사항 사전 명확화 단계 추가
  - 파일: `.agents/agents/master-orchestrator.md`
  - 추가 규칙:
    - MDX/AST 변환 관련 작업 시작 전 "입력 예제 → 기대 출력" 명세를 먼저 작성
    - 이미지/링크 경로 해결 로직 구현 시 프로젝트의 디렉토리 규칙을 docs/architecture.md에 먼저 문서화

#### 배운 점 (Lessons Learned)

1. **MDX 파싱 동작**:
   - MDX는 연속된 마크다운 블록을 하나의 `<p>` 태그에 개행 문자(`\n`)로 구분하여 파싱
   - 예: `> [!INFO] 제목\n본문` → `<p>[!INFO] 제목\n본문</p>`
   - remark는 마크다운 AST를 변환하고, rehype는 HTML AST를 변환하는 체인 구조

2. **Git Worktree 활용**:
   - 기능 개발(feature-dev)과 테스트 작성(test-spec)을 물리적으로 분리하여 병렬 작업 가능
   - merge 시점에 충돌이 발생하지만 각 브랜치의 역할이 명확하여 해결 용이

3. **Property-based 테스트 타임아웃**:
   - 비동기 컴포넌트 테스트에서 fast-check의 numRuns가 많으면 타임아웃 발생 가능
   - 타임아웃을 명시적으로 설정하거나 numRuns를 줄여야 함

4. **시맨틱 HTML 중요성**:
   - `<p><figure>` 중첩은 HTML 표준 위반
   - rehype 플러그인으로 이미지를 감싸는 불필요한 `<p>` 태그를 제거하여 해결

#### 워크플로우 효율성 평가

- **Git Flow 준수**: ✅ `develop → feature branch → 2 worktrees` 정상 운용
- **에이전트 분업**: ✅ feature-developer(기능) + test-specialist(테스트) 역할 분리 적절
- **병렬 작업**: ✅ Git Worktree로 기능 개발과 테스트 작성을 동시 진행하여 효율성 향상
- **커밋 품질**: ⚠️ 디버깅 커밋이 여러 번 반복되어 히스토리 가독성 저하
- **전체 소요 시간**: 32개 커밋, 약 5시간 소요 — 복잡한 파싱 로직으로 인한 반복 수정으로 시간 소요

### 2026-02-12 — PR #50: feat: 404, 403, 500 에러 페이지 구현

#### 변경 요약

- 변경 파일 10개, +735 / -7
- ErrorPage 공통 컴포넌트, Storybook 스토리, Unit 테스트 신규 추가
- TanStack Router errorComponent/notFoundComponent 통합 및 다국어(i18n) 리소스 추가

#### ✅ 잘한 점 (Keep)

- 병렬 실행으로 컴포넌트/테스트/스토리 작업을 분리해 효율적으로 진행
- 접근성(role="alert", aria-label)과 다크 모드까지 포함한 범용 컴포넌트 설계
- tech-architect 검증 점수 반영으로 스타일/타입 안정성 정리

#### 🔧 개선점 (Improve)

- named export vs default import 불일치로 통합 시점에 수정 발생
- Storybook args 타입 누락과 notFound 변경으로 기존 테스트 실패
- pre-commit 훅(tsc + vitest)에서 3회 실패로 수정 반복
- 권한 제약으로 pnpm 실행을 git-guardian에 의존

#### 🤖 에이전트 개선 제안 (Try)

- **feature-developer**: export 형태(default/named)를 작업 요약에 명시하고 공유
  - 파일: `.agents/agents/feature-developer.md`
  - 추가 규칙: 컴포넌트 공개 API(export 형태, props 필수값) 표준 템플릿 작성
- **test-specialist**: Storybook 스토리 작성 시 required args 체크리스트 추가
  - 파일: `.agents/agents/test-specialist.md`
  - 추가 규칙: 모든 스토리에 대해 args 타입 검증(필수/옵션) 확인
- **master-orchestrator**: 권한 제약 사전 고지 및 검증 위임 타이밍 명시
  - 파일: `.agents/agents/master-orchestrator.md`
  - 추가 규칙: pnpm 미보유 작업은 git-guardian 또는 lint-formatter에 위임 타이밍 명시
- **git-guardian**: pre-commit 실패 원인 유형(타입/테스트/스토리) 분류 기록
  - 파일: `.agents/agents/git-guardian.md`
  - 추가 규칙: 실패 2회 이상 시 원인 분류와 대응 조치 기록

### 2026-02-12 — PR #46: refactor: 기술부채 개선 — 타입 안전성, i18n, 파일명 규칙, UI 개선

#### 변경 요약

- 변경 파일 25개, +239 / -55
- `parseLocale()` 도입으로 locale 캐스팅 제거 및 타입 안전성 향상
- MDComponent 에러/로딩 UI 개선 + i18n 적용
- PostCardListSkeleton 추가 및 Suspense fallback 개선
- i18n 리소스/스키마에 post·markdown 키 추가 (ko/en/ja)
- Footer 연도 동적 처리, 파일명 kebab-case 정리
- opencode.json 읽기 명령어 권한 패턴 개선 포함

#### ✅ 잘한 점 (Keep)

- **타입 안전성 강화**: `as LocaleType` 제거 후 `parseLocale()` 도입으로 런타임 안전성 확보
- **i18n 일관성 확장**: UI 텍스트 번역 키를 스키마와 리소스에 동기화하여 언어 간 누락 방지
- **UX 개선 동시 달성**: MDX 에러/로딩 상태에 재시도 동작과 시각적 피드백 추가
- **테스트 신뢰성 유지**: 테스트 206/206 통과 및 실패 요인을 테스트 코드에서 즉시 보정

#### 🔧 개선점 (Problem)

- **테스트 실패 10건 발생**: feature 변경 후 테스트 모킹/하드코딩 값 업데이트가 지연됨
- **worktree 규칙 위반**: test-specialist가 메인 디렉토리 수정 → 복구 작업 필요
- **설정 변경 잔류**: opencode.json 변경이 세션 잔류분으로 PR에 포함되어 관심사 혼재
- **권한 제약 전가**: master-orchestrator의 제한된 git 권한으로 git-guardian 의존도가 증가

#### 🤖 에이전트 개선 제안 (Try)

- **feature-developer**: 변경 전 “테스트 영향 체크리스트” 추가
  - 파일: `.agents/agents/feature-developer.md`
  - 추가 규칙: i18n 키/문구 수정, UI 텍스트, 파일명 변경 시 관련 테스트(mock, snapshot, 문자열 하드코딩) 목록 작성 후 공유
- **test-specialist**: worktree 경로 확인 절차 의무화
  - 파일: `.agents/agents/test-specialist.md`
  - 추가 규칙: 작업 시작 전 `git worktree list`로 현재 경로 확인, 메인 디렉토리에서의 수정 금지 문구 강화
- **git-guardian**: 잔류 설정 변경 탐지 체크 추가
  - 파일: `.agents/agents/git-guardian.md`
  - 추가 규칙: PR 포함 파일 중 opencode.json이 있으면 “의도된 변경인지” 확인하고 별도 커밋 분리 권고
- **master-orchestrator**: 권한 제한 이슈 상시 공유 문구 추가
  - 파일: `.agents/agents/master-orchestrator.md`
  - 추가 규칙: 작업 시작 시 필요 git 명령 권한을 사전 점검하고 git-guardian 위임 타이밍 명시

#### 워크플로우 개선 제안

- **Worktree 경로 고정 규칙**: 작업 시작 시 worktree 경로를 PR 본문에 기록 → 디렉토리 혼용 방지
- **변경 영향 공유 템플릿**: feature-developer가 “변경 영향 요약(테스트/문서/i18n/파일명)”을 PR 본문에 추가
- **설정 변경 분리 원칙**: opencode.json 등 설정 변경은 별도 커밋/PR로 분리하여 리뷰 부담 감소
- **권한 위임 기준 표준화**: git-guardian에게 위임해야 하는 명령을 체크리스트로 운영

### 2026-02-11 — PR #40: 문서 구조 개편 - agents.md 분리 및 에이전트 프롬프트 최적화

#### 변경 요약

- 21개 파일 변경 (+1,236 / -1,329)
- `docs/agents.md` (955줄) → 허브 문서(140줄) + 9개 상세 문서 분리 (85% 축소)
- `.agents/agents/` 8개 에이전트 프롬프트 최적화 (1,545줄 → 1,235줄, 20% 감소)
- `opencode.json` 권한 설정 동기화

#### ✅ 잘한 점 (Keep)

- **체계적 Phase 분리**: 3단계 (문서 분리 → 프롬프트 최적화 → 일관성 검증)로 리스크 최소화
- **내용 무손실 분리**: 955줄 거대 문서를 9개 문서로 분리하면서 내용 100% 보존
- **프론트매터 보존**: 에이전트 프롬프트 최적화 시 YAML frontmatter 100% 유지 (동작 영향 없음)
- **상호 참조 체계**: 각 분리 문서에 `> 이 문서의 상위 문서: [agents.md](./agents.md)` 네비게이션 추가
- **검증 루프**: 각 Phase마다 tech-architect 검증 수행, Phase 3에서 doc-manager 교차 검증
- **중복 제거 원칙 일관 적용**: 에이전트 프롬프트에서 `docs/`와 중복되는 규칙을 참조(`→ 상세: docs/*.md`)로 교체

#### 🔧 개선점 (Problem)

- **커밋 중복**: 7개 커밋 중 동일 제목 커밋 존재 (commit 1과 3: `docs(agents): 문서 구조 개편 - 허브 문서 + 9개 상세 문서 분리`, commit 6과 7: `docs: 일관성 검증 개선 - 참조 누락 수정 및 구체화`). Phase별 squash 또는 명확한 커밋 구분 필요
- **opencode.json 변경 범위**: 문서 구조 개편 PR에 opencode.json 권한 설정까지 포함 (+182/-73). 관심사 분리가 아쉬움 — 별도 커밋 또는 PR로 분리하는 것이 리뷰 부담 감소
- **agents.md 최종 크기 불일치**: 커밋 메시지에 "~200줄"이라 했으나 실제 최종 크기는 약 140줄. 커밋 메시지의 정확성 개선 필요
- **PR 상태**: 아직 OPEN 상태 — 리뷰/머지 프로세스 진행 필요

#### 🤖 에이전트 개선 제안 (Try)

- **git-guardian**: 동일 제목 커밋 감지 로직 추가. `git log --oneline` 결과에서 중복 제목 발견 시 경고 및 squash 제안
  - 파일: `.agents/agents/git-guardian.md`
  - 추가 규칙: "커밋 생성 전 최근 5개 커밋과 제목 중복 여부 확인. 중복 시 `--amend` 또는 구체적 제목 사용 권장"
- **doc-manager**: 문서 분리 작업 시 "커밋 메시지 내 수치와 실제 파일 줄 수 일치 여부" 검증 체크리스트 추가
  - 파일: `.agents/agents/doc-manager.md`
- **master-orchestrator**: 대규모 설정 파일(opencode.json) 변경은 문서/코드 변경과 별도 커밋으로 분리하는 규칙 추가
  - 파일: `.agents/agents/master-orchestrator.md`

#### 워크플로우 효율성 평가

- **Git Flow 준수**: ✅ `develop → feature branch → worktrees` 정상 운용
- **에이전트 분업**: ✅ doc-manager(문서 작성) + tech-architect(검증) 역할 분리 적절
- **병렬 작업**: ⚠️ 이번 PR은 문서 전용이라 병렬 필요성 낮았으나, Phase 1~2는 독립적이므로 병렬 실행 가능했음
- **전체 소요 시간**: 7개 커밋, 약 30분 내 완료 — 문서 전용 작업치고 효율적

### 2026-02-11 (이전)

- 에이전트 권한 체계 전면 정비 (opencode.json + 문서 12개 동기화)
  - git add: git-guardian 전용으로 통합 (다른 에이전트에서 제거)
  - pnpm test/lint/tsc/fmt: 전문 에이전트만 보유 (orchestrator/git-guardian/github-helper에서 제거)
  - mkdir docs/\*: master-orchestrator → doc-manager 이관
  - lint-formatter edit에 기본 deny 추가
  - global permission에서 git add 관련 5개 항목 삭제
  - 권한 매트릭스 및 에이전트 프롬프트 전면 재검증

### 2026-02-08

- Next.js 16에서 TanStack Router v1 + Vite v7로 마이그레이션 완료
- 멀티 에이전트 시스템 활용 (Master Orchestrator + 6 Subagents)
- 빌드 성능 60% 개선, HMR 95% 개선, 번들 크기 25% 감소
- `@mdx-js/mdx`로 런타임 MDX 렌더링 전환 (`compile()` + `new Function()`)
- Git Worktree 기반 병렬 작업 전략 도입
