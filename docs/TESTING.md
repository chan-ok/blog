# í…ŒìŠ¤íŒ… ê°€ì´ë“œ

## ê°œìš”

ì´ ë¬¸ì„œëŠ” í”„ë¡œì íŠ¸ì˜ í…ŒìŠ¤íŠ¸ ì „ëµ, ë„êµ¬, ê·¸ë¦¬ê³  ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤ë¥¼ ë‹¤ë£¹ë‹ˆë‹¤.

## í…ŒìŠ¤íŠ¸ ìŠ¤íƒ

### í…ŒìŠ¤íŠ¸ ë„êµ¬

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            í…ŒìŠ¤íŠ¸ í”¼ë¼ë¯¸ë“œ                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  E2E Tests (Playwright)        [ì ìŒ]       â”‚
â”‚  â”œâ”€ ì‚¬ìš©ì í”Œë¡œìš°                            â”‚
â”‚  â””â”€ í¬ë¡œìŠ¤ ë¸Œë¼ìš°ì €                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Integration Tests (Vitest)    [ì¤‘ê°„]       â”‚
â”‚  â”œâ”€ ì»´í¬ë„ŒíŠ¸ í†µí•©                            â”‚
â”‚  â””â”€ API í†µí•©                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Unit Tests (Vitest)           [ë§ìŒ]       â”‚
â”‚  â”œâ”€ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜                            â”‚
â”‚  â”œâ”€ ì»¤ìŠ¤í…€ í›…                                â”‚
â”‚  â””â”€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Property-Based Tests (fast-check)          â”‚
â”‚  â”œâ”€ ë¬´ì‘ìœ„ ì…ë ¥ê°’ ê¸°ë°˜ ì†ì„± ê²€ì¦              â”‚
â”‚  â””â”€ ì—£ì§€ ì¼€ì´ìŠ¤ ìë™ íƒìƒ‰                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Component Tests                             â”‚
â”‚  â”œâ”€ Storybook (ì‹œê°ì  í…ŒìŠ¤íŠ¸)                â”‚
â”‚  â””â”€ Testing Library (ìƒí˜¸ì‘ìš©)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì„¤ì¹˜ëœ ë„êµ¬

#### 1. Vitest

- **ì—­í• **: ìœ ë‹› í…ŒìŠ¤íŠ¸ ë° í†µí•© í…ŒìŠ¤íŠ¸
- **ì‹¤í–‰**: `pnpm test`
- **ì„¤ì •**: `vitest.config.ts`

#### 2. Playwright

- **ì—­í• **: E2E í…ŒìŠ¤íŠ¸
- **ì‹¤í–‰**: `pnpm e2e`
- **ì„¤ì •**: `playwright.config.ts`

#### 3. Testing Library

- **ì—­í• **: ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸
- **íŒ¨í‚¤ì§€**: `@testing-library/react`, `@testing-library/dom`, `@testing-library/user-event`

#### 4. fast-check

- **ì—­í• **: Property-Based Testing (ì†ì„± ê¸°ë°˜ í…ŒìŠ¤íŠ¸)
- **íŒ¨í‚¤ì§€**: `fast-check`
- **ìš©ë„**: ë¬´ì‘ìœ„ ì…ë ¥ê°’ìœ¼ë¡œ "ëª¨ë“  ê²½ìš°ì— ëŒ€í•´ ì°¸ì´ì–´ì•¼ í•˜ëŠ” ê·œì¹™" ê²€ì¦

#### 5. Storybook

- **ì—­í• **: ì»´í¬ë„ŒíŠ¸ ì‹œê°ì  í…ŒìŠ¤íŠ¸ ë° ë¬¸ì„œí™”
- **ì‹¤í–‰**: `pnpm storybook`
- **í†µí•©**: Chromatic (ì‹œê°ì  íšŒê·€ í…ŒìŠ¤íŠ¸)

## í…ŒìŠ¤íŠ¸ ì „ëµ

### 1. ìœ ë‹› í…ŒìŠ¤íŠ¸ (Unit Tests)

**ëŒ€ìƒ**:

- ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
- ì»¤ìŠ¤í…€ í›…
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
- ìŠ¤í‚¤ë§ˆ ê²€ì¦ (Zod)

**ì‘ì„± ìœ„ì¹˜**: í…ŒìŠ¤íŠ¸ ëŒ€ìƒê³¼ ê°™ì€ ë””ë ‰í† ë¦¬ì— `.test.ts` ë˜ëŠ” `.spec.ts`

**ì˜ˆì‹œ êµ¬ì¡°**:

```
src/
â”œâ”€â”€ shared/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â””â”€â”€ ui/
â”‚   â”‚       â”œâ”€â”€ button.tsx
â”‚   â”‚       â”œâ”€â”€ button.test.tsx      # Unit + Property-Based í…ŒìŠ¤íŠ¸
â”‚   â”‚       â””â”€â”€ button.stories.tsx   # Storybook ìŠ¤í† ë¦¬
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ date-utils.ts
â”‚   â”‚   â””â”€â”€ date-utils.test.ts
â”‚   â””â”€â”€ hooks/
â”‚       â”œâ”€â”€ use-breakpoint.ts
â”‚       â””â”€â”€ use-breakpoint.test.ts
```

**ì‘ì„± ì˜ˆì‹œ**:

```typescript
// src/shared/lib/date-utils.test.ts
import { describe, it, expect } from 'vitest';
import { formatDate, parseDate } from './date-utils';

describe('formatDate', () => {
  it('should format date in ko locale', () => {
    const date = new Date('2025-12-06');
    expect(formatDate(date, 'ko')).toBe('2025ë…„ 12ì›” 6ì¼');
  });

  it('should format date in en locale', () => {
    const date = new Date('2025-12-06');
    expect(formatDate(date, 'en')).toBe('December 6, 2025');
  });
});
```

### 2. Property-Based í…ŒìŠ¤íŠ¸ (Property-Based Tests)

**ê°œë…**: íŠ¹ì • ì˜ˆì‹œê°€ ì•„ë‹Œ "ëª¨ë“  ê²½ìš°ì— ëŒ€í•´ ì°¸ì´ì–´ì•¼ í•˜ëŠ” ê·œì¹™(ì†ì„±)"ì„ ê²€ì¦í•˜ëŠ” í…ŒìŠ¤íŠ¸ ë°©ì‹

**ëŒ€ìƒ**:

- ë‹¤ì–‘í•œ ì…ë ¥ ì¡°í•©ì´ ìˆëŠ” ì»´í¬ë„ŒíŠ¸ (variant, shape ë“±)
- ì—£ì§€ ì¼€ì´ìŠ¤ê°€ ë§ì€ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
- ì¼ê´€ì„±ì´ ë³´ì¥ë˜ì–´ì•¼ í•˜ëŠ” ìŠ¤íƒ€ì¼/ë™ì‘

**ë„êµ¬**: fast-check + Vitest

**ì‘ì„± ìœ„ì¹˜**: í…ŒìŠ¤íŠ¸ ëŒ€ìƒê³¼ ê°™ì€ ë””ë ‰í† ë¦¬ì— `.test.tsx`

**í•µì‹¬ ê°œë…**:

```typescript
// Arbitrary: ë¬´ì‘ìœ„ ê°’ì„ ìƒì„±í•˜ëŠ” ìƒì„±ê¸°
const variantArb = fc.constantFrom<ButtonVariant>('primary', 'default', 'danger', 'link');
const shapeArb = fc.constantFrom<ButtonShape>('fill', 'outline');

// Property: ëª¨ë“  ì…ë ¥ì— ëŒ€í•´ ì°¸ì´ì–´ì•¼ í•˜ëŠ” ê·œì¹™
fc.assert(
  fc.property(variantArb, shapeArb, (variant, shape) => {
    // ì´ ë¸”ë¡ì€ ë¬´ì‘ìœ„ variant, shape ì¡°í•©ìœ¼ë¡œ ì—¬ëŸ¬ ë²ˆ ì‹¤í–‰ë¨
    const { unmount } = render(<Button variant={variant} shape={shape}>Test</Button>);
    const button = screen.getByRole('button');

    // ê²€ì¦: ëª¨ë“  ì¡°í•©ì—ì„œ ë‹¤í¬ ëª¨ë“œ í´ë˜ìŠ¤ê°€ í¬í•¨ë˜ì–´ì•¼ í•¨
    expect(button.className).toMatch(/dark:/);

    // ì¤‘ìš”: ê° ë°˜ë³µ í›„ unmount í˜¸ì¶œí•˜ì—¬ DOM ì •ë¦¬
    unmount();
  }),
  { numRuns: 50 } // 50íšŒ ë°˜ë³µ í…ŒìŠ¤íŠ¸
);
```

**ì‘ì„± ì˜ˆì‹œ** (ì‹¤ì œ Button ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸):

```typescript
// src/shared/components/ui/button.test.tsx
import { describe, it, expect, vi } from 'vitest';
import { render, screen } from '@testing-library/react';
import userEvent from '@testing-library/user-event';
import fc from 'fast-check';
import { Button, type ButtonVariant, type ButtonShape } from './button';

// ============================================================================
// Arbitraries (ë¬´ì‘ìœ„ ê°’ ìƒì„±ê¸°)
// ============================================================================

const variantArb = fc.constantFrom<ButtonVariant>('primary', 'default', 'danger', 'link');
const shapeArb = fc.constantFrom<ButtonShape>('fill', 'outline');
const nonLinkVariantArb = fc.constantFrom<ButtonVariant>('primary', 'default', 'danger');

// ============================================================================
// Property-Based í…ŒìŠ¤íŠ¸
// ============================================================================

describe('Property: Props ì „ë‹¬', () => {
  /**
   * aria-label ì†ì„±ì´ button ìš”ì†Œì— ì˜¬ë°”ë¥´ê²Œ ì „ë‹¬ë˜ëŠ”ì§€ ê²€ì¦
   */
  it('should pass aria attributes to the button element', () => {
    fc.assert(
      fc.property(fc.string({ minLength: 1, maxLength: 50 }), (label) => {
        const { unmount } = render(<Button aria-label={label}>Click me</Button>);
        const button = screen.getByRole('button');
        expect(button).toHaveAttribute('aria-label', label);
        unmount(); // Property-Based í…ŒìŠ¤íŠ¸ì—ì„œëŠ” ê° ë°˜ë³µ í›„ unmount í•„ìˆ˜
      }),
      { numRuns: 50 }
    );
  });

  /**
   * classNameì´ ê¸°ì¡´ ìŠ¤íƒ€ì¼ê³¼ ë³‘í•©ë˜ì–´ ì „ë‹¬ë˜ëŠ”ì§€ ê²€ì¦
   */
  it('should pass className to the button element', () => {
    fc.assert(
      fc.property(
        fc.stringMatching(/^[a-z][a-z0-9-]*$/), // ìœ íš¨í•œ CSS í´ë˜ìŠ¤ëª…
        variantArb,
        shapeArb,
        (customClass, variant, shape) => {
          const { unmount } = render(
            <Button variant={variant} shape={shape} className={customClass}>
              Click me
            </Button>
          );
          const button = screen.getByRole('button');
          expect(button.className).toContain(customClass);
          unmount();
        }
      ),
      { numRuns: 50 }
    );
  });
});

describe('Property: ì¼ê´€ëœ ê¸°ë³¸ ìŠ¤íƒ€ì¼ ì ìš©', () => {
  /**
   * linkë¥¼ ì œì™¸í•œ ëª¨ë“  variant/shape ì¡°í•©ì—ì„œ ê¸°ë³¸ ìŠ¤íƒ€ì¼ì´ ì ìš©ë˜ëŠ”ì§€ ê²€ì¦
   */
  it('should apply consistent base styles for non-link variants', () => {
    fc.assert(
      fc.property(nonLinkVariantArb, shapeArb, (variant, shape) => {
        const { unmount } = render(
          <Button variant={variant} shape={shape}>Test Button</Button>
        );
        const button = screen.getByRole('button');
        const className = button.className;

        expect(className).toContain('rounded-lg');  // ë‘¥ê·¼ ëª¨ì„œë¦¬
        expect(className).toContain('px-4');        // ìˆ˜í‰ íŒ¨ë”©
        expect(className).toContain('py-2');        // ìˆ˜ì§ íŒ¨ë”©
        expect(className).toContain('font-medium'); // í°íŠ¸ êµµê¸°
        unmount();
      }),
      { numRuns: 50 }
    );
  });
});

describe('Property: Link variantëŠ” shapeì„ ë¬´ì‹œí•¨', () => {
  /**
   * link variantëŠ” ì–´ë–¤ shapeì„ ì „ë‹¬í•´ë„ ë™ì¼í•œ ìŠ¤íƒ€ì¼ì´ ì ìš©ë˜ëŠ”ì§€ ê²€ì¦
   */
  it('should apply identical styles for link variant regardless of shape', () => {
    fc.assert(
      fc.property(shapeArb, (shape) => {
        const { unmount: unmount1 } = render(
          <Button variant="link" shape={shape}>Link Button 1</Button>
        );
        const button1 = screen.getByRole('button', { name: 'Link Button 1' });
        const className1 = button1.className;

        const { unmount: unmount2 } = render(
          <Button variant="link" shape="fill">Link Button 2</Button>
        );
        const button2 = screen.getByRole('button', { name: 'Link Button 2' });
        const className2 = button2.className;

        // shapeì´ ë¬´ì‹œë˜ë¯€ë¡œ classNameì´ ë™ì¼í•´ì•¼ í•¨
        expect(className1).toBe(className2);
        expect(className1).not.toContain('rounded-lg');
        expect(className1).toContain('bg-transparent');

        unmount1();
        unmount2();
      }),
      { numRuns: 50 }
    );
  });
});

describe('Property: ë‹¤í¬ ëª¨ë“œ í´ë˜ìŠ¤ í¬í•¨', () => {
  /**
   * ëª¨ë“  variant/shape ì¡°í•©ì—ì„œ ë‹¤í¬ ëª¨ë“œ í´ë˜ìŠ¤ê°€ í¬í•¨ë˜ëŠ”ì§€ ê²€ì¦
   */
  it('should include dark mode classes for all variant/shape combinations', () => {
    fc.assert(
      fc.property(variantArb, shapeArb, (variant, shape) => {
        const { unmount } = render(
          <Button variant={variant} shape={shape}>Test Button</Button>
        );
        const button = screen.getByRole('button');
        expect(button.className).toMatch(/dark:/);
        unmount();
      }),
      { numRuns: 50 }
    );
  });
});
```

**Property-Based vs Unit í…ŒìŠ¤íŠ¸ ë¹„êµ**:

| êµ¬ë¶„        | Unit í…ŒìŠ¤íŠ¸        | Property-Based í…ŒìŠ¤íŠ¸ |
| ----------- | ------------------ | --------------------- |
| ì…ë ¥ê°’      | ê°œë°œìê°€ ì§ì ‘ ì§€ì • | ë¬´ì‘ìœ„ ìë™ ìƒì„±      |
| ê²€ì¦ ëŒ€ìƒ   | íŠ¹ì • ì‹œë‚˜ë¦¬ì˜¤      | ëª¨ë“  ê²½ìš°ì— ëŒ€í•œ ê·œì¹™ |
| ì—£ì§€ ì¼€ì´ìŠ¤ | ìˆ˜ë™ìœ¼ë¡œ ì¶”ê°€      | ìë™ íƒìƒ‰             |
| ì í•©í•œ ê²½ìš° | êµ¬ì²´ì  ë™ì‘ ê²€ì¦   | ì¼ê´€ì„±/ë¶ˆë³€ì„± ê²€ì¦    |

### 3. ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸ (Component Tests)

**ëŒ€ìƒ**:

- UI ì»´í¬ë„ŒíŠ¸
- ì‚¬ìš©ì ìƒí˜¸ì‘ìš©
- ì¡°ê±´ë¶€ ë Œë”ë§

**ë„êµ¬**: Testing Library + Vitest

**ì‘ì„± ìœ„ì¹˜**: ì»´í¬ë„ŒíŠ¸ì™€ ê°™ì€ ë””ë ‰í† ë¦¬

**ì‘ì„± ì˜ˆì‹œ**:

```typescript
// src/shared/components/ui/button.test.tsx (Unit í…ŒìŠ¤íŠ¸ ë¶€ë¶„)
import { describe, it, expect, vi } from 'vitest';
import { render, screen } from '@testing-library/react';
import userEvent from '@testing-library/user-event';
import Button from './button';

describe('Button Component - Unit Tests', () => {
  it('renders children correctly', () => {
    render(<Button>Click me</Button>);
    expect(screen.getByRole('button')).toHaveTextContent('Click me');
  });

  it('applies default variant and shape when not specified', () => {
    render(<Button>Default Button</Button>);
    const button = screen.getByRole('button');
    expect(button.className).toContain('bg-gray-100');
    expect(button.className).toContain('text-gray-900');
  });

  it('applies disabled styles when disabled', () => {
    render(<Button disabled>Disabled</Button>);
    const button = screen.getByRole('button');
    expect(button.className).toContain('disabled:opacity-50');
    expect(button.className).toContain('disabled:cursor-not-allowed');
  });

  it('does not call onClick when disabled', async () => {
    const handleClick = vi.fn();
    const user = userEvent.setup();

    render(<Button disabled onClick={handleClick}>Disabled</Button>);
    await user.click(screen.getByRole('button'));

    expect(handleClick).not.toHaveBeenCalled();
  });
});
```

### 3. í†µí•© í…ŒìŠ¤íŠ¸ (Integration Tests)

**ëŒ€ìƒ**:

- Feature ë ˆë²¨ í†µí•© (ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ + ë¡œì§)
- API í†µí•©
- ë°ì´í„° íë¦„

**ì‘ì„± ì˜ˆì‹œ**:

```typescript
// src/features/contact/contact-form.test.tsx
import { describe, it, expect, vi } from 'vitest';
import { render, screen, waitFor } from '@testing-library/react';
import userEvent from '@testing-library/user-event';
import { ContactForm } from './contact-form';

// Mock fetch
global.fetch = vi.fn();

describe('ContactForm Integration', () => {
  beforeEach(() => {
    vi.clearAllMocks();
  });

  it('should submit form successfully', async () => {
    const mockFetch = vi.mocked(fetch);
    mockFetch.mockResolvedValueOnce({
      ok: true,
      json: async () => ({ status: 'sent' }),
    } as Response);

    render(<ContactForm />);

    // Fill form
    await userEvent.type(screen.getByLabelText(/email/i), 'test@example.com');
    await userEvent.type(screen.getByLabelText(/subject/i), 'Test Subject');
    await userEvent.type(screen.getByLabelText(/message/i), 'Test Message');

    // Submit
    await userEvent.click(screen.getByRole('button', { name: /send/i }));

    // Verify API call
    await waitFor(() => {
      expect(mockFetch).toHaveBeenCalledWith('/api/mail', expect.any(Object));
    });

    // Verify success message
    expect(screen.getByText(/success/i)).toBeInTheDocument();
  });

  it('should show validation errors', async () => {
    render(<ContactForm />);

    // Submit without filling
    await userEvent.click(screen.getByRole('button', { name: /send/i }));

    // Verify error messages
    expect(screen.getByText(/email is required/i)).toBeInTheDocument();
  });
});
```

### 4. E2E í…ŒìŠ¤íŠ¸ (End-to-End Tests)

**ëŒ€ìƒ**:

- ì£¼ìš” ì‚¬ìš©ì í”Œë¡œìš°
- í¬ë¦¬í‹°ì»¬ ê²½ë¡œ
- í¬ë¡œìŠ¤ ë¸Œë¼ìš°ì € í˜¸í™˜ì„±

**ë„êµ¬**: Playwright

**ì‘ì„± ìœ„ì¹˜**: `e2e/` ë””ë ‰í† ë¦¬

**ì‘ì„± ì˜ˆì‹œ**:

```typescript
// e2e/contact.spec.ts
import { test, expect } from '@playwright/test';

test.describe('Contact Form', () => {
  test('should submit contact form successfully', async ({ page }) => {
    // Navigate to contact page
    await page.goto('/ko/contact');

    // Fill form
    await page.fill('input[name="email"]', 'test@example.com');
    await page.fill('input[name="subject"]', 'Test Subject');
    await page.fill('textarea[name="message"]', 'Test Message');

    // Wait for Turnstile
    await page.waitForSelector('[data-turnstile="success"]');

    // Submit
    await page.click('button[type="submit"]');

    // Verify success
    await expect(page.locator('text=Success')).toBeVisible();
  });

  test('should navigate between locales', async ({ page }) => {
    await page.goto('/ko');

    // Switch to English
    await page.click('[data-testid="locale-switcher"]');
    await page.click('text=English');

    // Verify URL changed
    await expect(page).toHaveURL('/en');
  });
});
```

### 5. ì‹œê°ì  í…ŒìŠ¤íŠ¸ (Visual Tests)

**ë„êµ¬**: Storybook + Chromatic

**ì‘ì„± ìœ„ì¹˜**: ì»´í¬ë„ŒíŠ¸ì™€ ê°™ì€ ë””ë ‰í† ë¦¬ì— `.stories.tsx`

**ì‘ì„± ì˜ˆì‹œ**:

```typescript
// src/shared/ui/button.stories.tsx
import type { Meta, StoryObj } from '@storybook/react';
import Button from './button';

const meta = {
  title: 'UI/Button',
  component: Button,
  tags: ['autodocs'],
  argTypes: {
    variant: {
      control: 'select',
      options: ['primary', 'secondary', 'outline'],
    },
  },
} satisfies Meta<typeof Button>;

export default meta;
type Story = StoryObj<typeof meta>;

export const Primary: Story = {
  args: {
    children: 'Primary Button',
    variant: 'primary',
  },
};

export const Secondary: Story = {
  args: {
    children: 'Secondary Button',
    variant: 'secondary',
  },
};

export const Disabled: Story = {
  args: {
    children: 'Disabled Button',
    disabled: true,
  },
};
```

## í…ŒìŠ¤íŠ¸ ì‹¤í–‰

### ëª…ë ¹ì–´

```bash
# ìœ ë‹›/í†µí•© í…ŒìŠ¤íŠ¸ (Watch ëª¨ë“œ)
pnpm test

# í…ŒìŠ¤íŠ¸ 1íšŒ ì‹¤í–‰
pnpm test:run

# ì»¤ë²„ë¦¬ì§€ í™•ì¸
pnpm coverage

# E2E í…ŒìŠ¤íŠ¸
pnpm e2e

# E2E UI ëª¨ë“œ
pnpm e2e:ui

# Storybook ì‹¤í–‰
pnpm storybook

# Storybook ë¹Œë“œ
pnpm build-storybook
```

### CI/CDì—ì„œ ì‹¤í–‰

```yaml
# .github/workflows/test.yml
name: Test

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '20'

      - name: Install pnpm
        uses: pnpm/action-setup@v2

      - name: Install dependencies
        run: pnpm install

      - name: Run tests
        run: pnpm test:run

      - name: Run E2E tests
        run: pnpm e2e

      - name: Upload coverage
        uses: codecov/codecov-action@v3
```

## í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€

### ëª©í‘œ

- **ì „ì²´**: 80% ì´ìƒ
- **ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜**: 90% ì´ìƒ
- **ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§**: 85% ì´ìƒ
- **UI ì»´í¬ë„ŒíŠ¸**: 70% ì´ìƒ

### ì»¤ë²„ë¦¬ì§€ í™•ì¸

```bash
pnpm coverage
```

ê²°ê³¼ëŠ” `coverage/` ë””ë ‰í† ë¦¬ì— HTML ë¦¬í¬íŠ¸ë¡œ ìƒì„±ë©ë‹ˆë‹¤.

### ì»¤ë²„ë¦¬ì§€ ì˜ˆì™¸

ë‹¤ìŒ íŒŒì¼ë“¤ì€ ì»¤ë²„ë¦¬ì§€ì—ì„œ ì œì™¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- Storybook ìŠ¤í† ë¦¬ íŒŒì¼ (`*.stories.tsx`)
- íƒ€ì… ì •ì˜ íŒŒì¼ (`*.d.ts`)
- ì„¤ì • íŒŒì¼ (`*.config.ts`)
- Next.js App Router íŒŒì¼ (`app/**/page.tsx`, `app/**/layout.tsx`)

## ëª¨í‚¹ (Mocking)

### 1. ëª¨ë“ˆ ëª¨í‚¹

```typescript
import { vi } from 'vitest';

// ì „ì²´ ëª¨ë“ˆ ëª¨í‚¹
vi.mock('axios');

// ë¶€ë¶„ ëª¨í‚¹
vi.mock('./utils', () => ({
  ...vi.importActual('./utils'),
  fetchData: vi.fn(),
}));
```

### 2. í™˜ê²½ ë³€ìˆ˜ ëª¨í‚¹

```typescript
import { vi } from 'vitest';

beforeAll(() => {
  vi.stubEnv('NEXT_PUBLIC_GIT_RAW_URL', 'https://example.com');
});

afterAll(() => {
  vi.unstubAllEnvs();
});
```

### 3. Next.js ë¼ìš°í„° ëª¨í‚¹

```typescript
import { vi } from 'vitest';

vi.mock('next/navigation', () => ({
  useRouter: () => ({
    push: vi.fn(),
    pathname: '/ko',
  }),
  usePathname: () => '/ko',
}));
```

### 4. Fetch ëª¨í‚¹

```typescript
global.fetch = vi.fn();

const mockFetch = vi.mocked(fetch);
mockFetch.mockResolvedValueOnce({
  ok: true,
  json: async () => ({ data: 'test' }),
} as Response);
```

## ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤

### 1. AAA íŒ¨í„´

```typescript
it('should do something', () => {
  // Arrange (ì¤€ë¹„)
  const input = 'test';

  // Act (ì‹¤í–‰)
  const result = myFunction(input);

  // Assert (ê²€ì¦)
  expect(result).toBe('expected');
});
```

### 2. í…ŒìŠ¤íŠ¸ ê²©ë¦¬

```typescript
describe('Feature', () => {
  beforeEach(() => {
    // ê° í…ŒìŠ¤íŠ¸ ì „ ì´ˆê¸°í™”
    vi.clearAllMocks();
  });

  it('test 1', () => {
    // ë…ë¦½ì ì¸ í…ŒìŠ¤íŠ¸
  });

  it('test 2', () => {
    // test 1ì— ì˜ì¡´í•˜ì§€ ì•ŠìŒ
  });
});
```

### 3. ëª…í™•í•œ í…ŒìŠ¤íŠ¸ ì´ë¦„

```typescript
// âŒ Bad
it('works', () => { ... });

// âœ… Good - Unit í…ŒìŠ¤íŠ¸
it('should return formatted date in ko locale', () => { ... });

// âœ… Good - Property-Based í…ŒìŠ¤íŠ¸
it('should apply consistent base styles for non-link variants', () => { ... });
```

### 4. ì‚¬ìš©ì ê´€ì ì—ì„œ í…ŒìŠ¤íŠ¸

```typescript
// âŒ Bad - êµ¬í˜„ ì„¸ë¶€ì‚¬í•­ í…ŒìŠ¤íŠ¸
expect(component.state.isOpen).toBe(true);

// âœ… Good - ì‚¬ìš©ìê°€ ë³´ëŠ” ê²ƒ í…ŒìŠ¤íŠ¸
expect(screen.getByRole('dialog')).toBeVisible();
```

### 5. ë¹„ë™ê¸° ì²˜ë¦¬

```typescript
// waitFor ì‚¬ìš©
await waitFor(() => {
  expect(screen.getByText('Loaded')).toBeInTheDocument();
});

// findBy ì‚¬ìš© (ìë™ ëŒ€ê¸°)
const element = await screen.findByText('Loaded');
expect(element).toBeInTheDocument();
```

### 6. ì ‘ê·¼ì„± ê¸°ë°˜ ì¿¼ë¦¬

```typescript
// âŒ Bad
screen.getByTestId('submit-button');

// âœ… Good
screen.getByRole('button', { name: /submit/i });
```

### 7. Property-Based í…ŒìŠ¤íŠ¸ ì‘ì„± ê°€ì´ë“œ

```typescript
// Arbitrary ì •ì˜: í…ŒìŠ¤íŠ¸í•  ê°’ì˜ ë²”ìœ„ë¥¼ ëª…í™•íˆ ì§€ì •
const variantArb = fc.constantFrom<ButtonVariant>(
  'primary',
  'default',
  'danger',
  'link'
);

// numRuns ì„¤ì •: í…ŒìŠ¤íŠ¸ ëª©ì ì— ë§ê²Œ ë°˜ë³µ íšŸìˆ˜ ì¡°ì •
fc.assert(
  fc.property(variantArb, (variant) => {
    // ê²€ì¦ ë¡œì§
  }),
  { numRuns: 50 } // ê¸°ë³¸ê°’ 100, ë¹ ë¥¸ í”¼ë“œë°±ì„ ìœ„í•´ 50 ê¶Œì¥
);

// íŠ¹ìˆ˜ ì¼€ì´ìŠ¤ ë¶„ë¦¬: link variantì²˜ëŸ¼ ë‹¤ë¥¸ ê·œì¹™ì„ ë”°ë¥´ëŠ” ê²½ìš° ë³„ë„ í…ŒìŠ¤íŠ¸
const nonLinkVariantArb = fc.constantFrom<ButtonVariant>(
  'primary',
  'default',
  'danger'
);
```

### 8. Property-Based í…ŒìŠ¤íŠ¸ì—ì„œ unmount í˜¸ì¶œ

Property-Based í…ŒìŠ¤íŠ¸ëŠ” ë™ì¼í•œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ë‚´ì—ì„œ ì—¬ëŸ¬ ë²ˆ ë Œë”ë§ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. ì´ë•Œ ê° ë°˜ë³µ(iteration)ì´ ëë‚  ë•Œë§ˆë‹¤ `unmount()`ë¥¼ ëª…ì‹œì ìœ¼ë¡œ í˜¸ì¶œí•˜ì—¬ DOMì„ ì •ë¦¬í•´ì•¼ í•©ë‹ˆë‹¤.

**ì™œ í•„ìš”í•œê°€?**

- `fc.assert`ëŠ” í•˜ë‚˜ì˜ `it` ë¸”ë¡ ë‚´ì—ì„œ ì—¬ëŸ¬ ë²ˆ ì‹¤í–‰ë¨
- Testing Libraryì˜ ìë™ cleanupì€ `it` ë¸”ë¡ì´ ëë‚  ë•Œë§Œ ë™ì‘
- ëª…ì‹œì  `unmount()` ì—†ì´ëŠ” ì´ì „ ë Œë”ë§ì˜ ìš”ì†Œê°€ DOMì— ë‚¨ì•„ í…ŒìŠ¤íŠ¸ ê°„ì„­ ë°œìƒ

```typescript
// âŒ Bad - unmount ì—†ì´ Property-Based í…ŒìŠ¤íŠ¸
it('should apply styles', () => {
  fc.assert(
    fc.property(variantArb, (variant) => {
      render(<Button variant={variant}>Test</Button>);
      const button = screen.getByRole('button');
      expect(button.className).toMatch(/dark:/);
      // ë‹¤ìŒ ë°˜ë³µì—ì„œ ì´ì „ ë²„íŠ¼ì´ DOMì— ë‚¨ì•„ìˆìŒ!
    }),
    { numRuns: 50 }
  );
});

// âœ… Good - ê° ë°˜ë³µ í›„ unmount í˜¸ì¶œ
it('should apply styles', () => {
  fc.assert(
    fc.property(variantArb, (variant) => {
      const { unmount } = render(<Button variant={variant}>Test</Button>);
      const button = screen.getByRole('button');
      expect(button.className).toMatch(/dark:/);
      unmount(); // ê° ë°˜ë³µì´ ëë‚  ë•Œ DOM ì •ë¦¬
    }),
    { numRuns: 50 }
  );
});
```

**ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§í•˜ëŠ” ê²½ìš°:**

```typescript
it('should apply identical styles for link variant regardless of shape', () => {
  fc.assert(
    fc.property(shapeArb, (shape) => {
      const { unmount: unmount1 } = render(
        <Button variant="link" shape={shape}>Link Button 1</Button>
      );
      const { unmount: unmount2 } = render(
        <Button variant="link" shape="fill">Link Button 2</Button>
      );

      // ê²€ì¦ ë¡œì§...

      // ëª¨ë“  ë Œë”ë§ëœ ì»´í¬ë„ŒíŠ¸ ì •ë¦¬
      unmount1();
      unmount2();
    }),
    { numRuns: 50 }
  );
});
```

> **ì°¸ê³ **: ì¼ë°˜ Unit í…ŒìŠ¤íŠ¸ì—ì„œëŠ” Testing Libraryê°€ ê° `it` ë¸”ë¡ í›„ ìë™ìœ¼ë¡œ cleanupí•˜ë¯€ë¡œ `unmount()`ë¥¼ ëª…ì‹œì ìœ¼ë¡œ í˜¸ì¶œí•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤. Property-Based í…ŒìŠ¤íŠ¸ì—ì„œë§Œ ì´ íŒ¨í„´ì´ í•„ìš”í•©ë‹ˆë‹¤.

### 9. í…ŒìŠ¤íŠ¸ ë¬¸ì„œí™”

í…ŒìŠ¤íŠ¸ íŒŒì¼ ìƒë‹¨ì— í…ŒìŠ¤íŠ¸ ì¢…ë¥˜ì™€ ëª©ì ì„ ëª…ì‹œ:

```typescript
/**
 * ============================================================================
 * Button ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸
 * ============================================================================
 *
 * ## í…ŒìŠ¤íŠ¸ ì¢…ë¥˜
 *
 * 1. **Property-Based í…ŒìŠ¤íŠ¸**: fast-checkë¡œ ë¬´ì‘ìœ„ ì…ë ¥ê°’ ê²€ì¦
 * 2. **Unit í…ŒìŠ¤íŠ¸**: íŠ¹ì • ì‹œë‚˜ë¦¬ì˜¤ì— ëŒ€í•œ êµ¬ì²´ì ì¸ ë™ì‘ ê²€ì¦
 *
 * ## ì‚¬ìš©ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬
 *
 * - vitest: í…ŒìŠ¤íŠ¸ ëŸ¬ë„ˆ
 * - @testing-library/react: ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ ë° DOM ì¿¼ë¦¬
 * - fast-check: Property-Based í…ŒìŠ¤íŠ¸ìš© ë¬´ì‘ìœ„ ë°ì´í„° ìƒì„±
 */
```

## í…ŒìŠ¤íŠ¸í•˜ê¸° ì–´ë ¤ìš´ ê²½ìš°

### 1. Turnstile Widget

Turnstileì€ E2E í…ŒìŠ¤íŠ¸ì—ì„œë§Œ í…ŒìŠ¤íŠ¸í•˜ê³ , ìœ ë‹›/í†µí•© í…ŒìŠ¤íŠ¸ì—ì„œëŠ” ëª¨í‚¹:

```typescript
vi.mock('@/widgets/turnstile', () => ({
  Turnstile: ({ onSuccess }: { onSuccess: (token: string) => void }) => {
    useEffect(() => {
      onSuccess('mock-token');
    }, []);
    return <div data-testid="turnstile-mock" />;
  },
}));
```

### 2. MDX ë Œë”ë§

MDX ë Œë”ë§ì€ í†µí•© í…ŒìŠ¤íŠ¸ ë ˆë²¨ì—ì„œ í…ŒìŠ¤íŠ¸:

```typescript
it('should render MDX content', async () => {
  const mockMDX = '# Title\n\nContent';
  render(<MDXRenderer source={mockMDX} />);

  expect(await screen.findByRole('heading', { level: 1 })).toHaveTextContent('Title');
  expect(screen.getByText('Content')).toBeInTheDocument();
});
```

### 3. ì™¸ë¶€ API í˜¸ì¶œ

í•­ìƒ ëª¨í‚¹í•˜ì—¬ í…ŒìŠ¤íŠ¸:

```typescript
vi.mock('@/features/post/util/get-posts', () => ({
  getPosts: vi.fn().mockResolvedValue([{ id: '1', title: 'Test Post' }]),
}));
```

## ë””ë²„ê¹…

### Vitest

```typescript
// ë””ë²„ê±° ì‚¬ìš©
it('should work', () => {
  debugger; // ë˜ëŠ” ë¸Œë ˆì´í¬í¬ì¸íŠ¸
  expect(result).toBe('expected');
});
```

### Testing Library

```typescript
import { screen } from '@testing-library/react';

// DOM íŠ¸ë¦¬ ì¶œë ¥
screen.debug();

// íŠ¹ì • ìš”ì†Œ ì¶œë ¥
screen.debug(screen.getByRole('button'));
```

### Playwright

```typescript
// í—¤ë“œë¦¬ìŠ¤ ëª¨ë“œ ë¹„í™œì„±í™”
test.use({ headless: false });

// ëŠë¦° ëª¨ì…˜
test.use({ slowMo: 1000 });

// ë””ë²„ê·¸ ëª¨ë“œ
await page.pause();
```

## ì°¸ê³  ìë£Œ

### ê³µì‹ ë¬¸ì„œ

- [Vitest](https://vitest.dev/)
- [Playwright](https://playwright.dev/)
- [Testing Library](https://testing-library.com/)
- [Storybook](https://storybook.js.org/)

### ê°€ì´ë“œ

- [Testing Library Best Practices](https://kentcdodds.com/blog/common-mistakes-with-react-testing-library)
- [Playwright Best Practices](https://playwright.dev/docs/best-practices)
- [Testing Trophy](https://kentcdodds.com/blog/the-testing-trophy-and-testing-classifications)

## í…ŒìŠ¤íŠ¸ ì‘ì„± í˜„í™© ë° ê³„íš

### ì‘ì„± ì™„ë£Œ

- [x] `src/shared/components/ui/button.test.tsx` - Button ì»´í¬ë„ŒíŠ¸ (Property-Based + Unit) (2025-12-13 ì™„ë£Œ)
  - Property-Based í…ŒìŠ¤íŠ¸: Props ì „ë‹¬, ê¸°ë³¸ ìŠ¤íƒ€ì¼, Link variant ê·œì¹™, ë‹¤í¬ ëª¨ë“œ
  - Unit í…ŒìŠ¤íŠ¸: children ë Œë”ë§, ê¸°ë³¸ê°’ ì ìš©, disabled ìƒíƒœ

### Phase 1: ìœ í‹¸ë¦¬í‹° & ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§

- [ ] `src/shared/lib/` ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
- [ ] `src/shared/hooks/` ì»¤ìŠ¤í…€ í›…
- [ ] Zod ìŠ¤í‚¤ë§ˆ ê²€ì¦ ë¡œì§

### Phase 2: ì»´í¬ë„ŒíŠ¸

- [ ] `src/shared/components/ui/` ê¸°ë³¸ UI ì»´í¬ë„ŒíŠ¸ (Button ì™„ë£Œ)
- [ ] `src/features/*/ui/` Feature ì»´í¬ë„ŒíŠ¸
- [ ] `src/widgets/` Widget ì»´í¬ë„ŒíŠ¸

### Phase 3: í†µí•© ê¸°ëŠ¥

- [ ] Contact í¼ ì „ì²´ í”Œë¡œìš°
- [ ] Posts ëª©ë¡ ë° ìƒì„¸ í˜ì´ì§€
- [ ] ì–¸ì–´ ì „í™˜ ê¸°ëŠ¥

### Phase 4: E2E

- [ ] ì£¼ìš” ì‚¬ìš©ì í”Œë¡œìš° (í™ˆ â†’ í¬ìŠ¤íŠ¸ â†’ Contact)
- [ ] ë‹¤êµ­ì–´ ë„¤ë¹„ê²Œì´ì…˜
- [ ] í¼ ì œì¶œ í”Œë¡œìš°

## ê´€ë ¨ ë¬¸ì„œ

- [ê°œë°œ ê·œì¹™](./rule.md) - í•µì‹¬ ê°œë°œ ì›ì¹™
- [ì½”ë“œ ìŠ¤íƒ€ì¼ ê°€ì´ë“œ](./code-style.md) - ì½”ë“œ ì‘ì„± ê·œì¹™
- [ì•„í‚¤í…ì²˜](./architecture.md) - FSD êµ¬ì¡°

---

> ğŸ“– ì „ì²´ ë¬¸ì„œ ëª©ë¡ì€ [ë¬¸ì„œ í™ˆ](../README.md)ì„ ì°¸ê³ í•˜ì„¸ìš”.
