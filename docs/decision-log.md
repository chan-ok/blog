# 의사결정 로그

> 이 문서는 인간(나)과 AI의 협업 과정을 기록합니다.
> 각 의사결정에서 내가 어떤 생각을 했고, AI에게 무엇을 요청했으며, AI는 어떻게 판단했는지를 추적합니다.
> 이를 통해 협업 패턴을 개선하고, 더 나은 결과물을 만들어가는 것이 목표입니다.

---

## 요약

### 지금까지의 개발 내용

Next.js 16 기반 다국어 블로그를 약 3주간 개발. 콘텐츠 리포지터리 분리, 다크 모드, FSD 아키텍처까지 점진적으로 확장 중.

| Phase              | 기간          | 주요 작업                                                        |
| ------------------ | ------------- | ---------------------------------------------------------------- |
| 1. 기반 구축       | 11/20 ~ 11/24 | 프로젝트 초기 설정, Contact 폼 (Zod + Turnstile + Resend)        |
| 2. 국제화와 콘텐츠 | 11/26 ~ 12/02 | URL 기반 다국어 지원, 원격 MDX 렌더링 (리포지터리 분리)          |
| 3. 사용자 경험     | 12/04 ~ 12/10 | 다크 모드, 언어 선택기                                           |
| 4. 아키텍처 정제   | 12/12 ~ 현재  | FSD 아키텍처, Button/Link 컴포넌트, i18next, Giscus 댓글, 문서화 |

### 내 생각/의도의 주된 성향

- **실용주의**: 완벽한 설계보다 빠르게 동작하는 코드를 우선시. 이후 점진적 리팩토링 선호
- **독립성 추구**: 콘텐츠와 코드 분리, 기능 단위 독립적 개발/테스트 지향
- **개인 니즈 기반**: 야간 작업으로 인한 다크 모드, Obsidian 연동 등 실제 사용 환경에서 출발
- **학습 목적**: 모던 기술 스택(Next.js 16, React 19, FSD 등)을 직접 적용하며 체득

### 주로 변경되었던 AI의 판단들

| 영역          | 초기 판단              | 변경된 방향                 | 원인                                    |
| ------------- | ---------------------- | --------------------------- | --------------------------------------- |
| 언어 영속성   | NEXT_LOCALE 쿠키       | URL + Zustand 조합          | proxy에서 쿠키 읽기 실패                |
| MDX 렌더링    | next/mdx (내부 import) | next-mdx-remote-client      | 원격 파일에서 set-mdx-components 미동작 |
| 디렉토리 구조 | 초기 FSD 전체 적용     | features/ 우선, 점진적 분리 | 레이어 구분 기준 불명확                 |
| Toast 알림    | 구현 완료              | revert                      | 디자인 시스템 미정의                    |

---

## 문서 구조 가이드

각 의사결정은 다음 형식으로 기록합니다:

```
### [결정 제목]

**내 생각/의도**
- 이 결정을 내리게 된 배경과 내가 원했던 것

**AI에게 요청한 내용**
- 실제로 AI에게 전달한 프롬프트나 지시사항

**AI의 판단/결과**
- AI가 제안한 내용과 실제 구현 결과

**추가 수정 사항** (있는 경우)
- 초기 결과와 달랐던 점, 추가로 요청한 수정

**배운 점/개선 포인트**
- 다음에 더 잘하기 위한 인사이트
```

---

## Phase 1: 기반 구축 (2025-11-20 ~ 11-24)

### 프로젝트 초기 설정 (2025-11-20)

> 🤖 AI에 의해 git 이력 기반으로 기록됨

**내 생각/의도**

- Next.js 기반의 개인 블로그를 구축하고자 함
- 모던 프론트엔드 기술 스택을 학습하고 적용하는 플랫폼으로 활용

**AI에게 요청한 내용**

- 초기 설정은 Create Next App으로 시작, 이후 구조 개선 요청

**AI의 판단/결과**

- Next.js + TypeScript + Tailwind CSS 기본 구조 생성
- ESLint, Prettier, Husky, lint-staged 설정 추가
- MDX 지원을 위한 설정 추가
- Header, Footer 컴포넌트 분리

**배운 점/개선 포인트**

- 초반에는 필요한 환경설정만 빠르게 구축하고, 실행 및 배포 가능한 구조를 만드는 것이 중요
- 앞으로 사용할 예정인 라이브러리 환경설정에 과도한 시간을 투자했음

---

### Contact 폼 구현 (2025-11-24 ~ 11-25)

> 🤖 AI에 의해 git 이력 기반으로 기록됨

**내 생각/의도**

- 방문자가 연락할 수 있는 폼 필요
- 봇 방지 및 이메일 발송 기능 필요

**AI에게 요청한 내용**

- Zod 검증, Cloudflare Turnstile, Resend 연동 요청

**AI의 판단/결과**

- Zod 스키마 기반 폼 검증 구현
- Cloudflare Turnstile 봇 방지 연동
- Netlify Functions + Resend로 이메일 발송
- Toast 알림 UI 추가

**추가 수정 사항**

- 이메일 파싱 로직 수정 (여러 번 revert 후 재구현)
- 발신자 이메일 처리 방식 개선

**배운 점/개선 포인트**

- Toast 알림을 구현하려 했으나, 전체 디자인 시스템 정의가 부족하여 고민 끝에 revert. 추후 전송 성공 알림은 필요함
- 초반에 Cloudflare Turnstile 없이 배포했을 때 AI 봇에 의한 스팸 메일 전송이 발생. 과도한 크롤링으로 인한 요금 폭탄 우려로 우선 조치했고, 이후 봇에 의한 이메일 전송은 완전히 차단됨

---

## Phase 2: 국제화와 콘텐츠 (2025-11-26 ~ 12-02)

### URL 기반 다국어 지원 (2025-11-26)

> 🤖 AI에 의해 git 이력 기반으로 기록됨

**내 생각/의도**

- 한국어, 일본어, 영어 3개 언어 지원 필요
- SEO 친화적인 URL 구조 원함

**AI에게 요청한 내용**

- locale 기반 라우팅 구현 요청

**AI의 판단/결과**

- `[locale]` 동적 세그먼트를 사용한 App Router 구조
- `/ko/`, `/ja/`, `/en/` URL 패턴 적용
- 브라우저 언어 감지 및 리다이렉션 (proxy.ts)

**배운 점/개선 포인트**

- URL 기반 i18n은 SEO와 링크 공유에 유리함
- 초기에 Zustand에서 NEXT_LOCALE 쿠키 기반으로 전환하려 했으나, 페이지 이동 시 locale 정보가 유지되지 않는 문제 발생. proxy를 거치는 과정에서 쿠키를 읽지 못하는 것이 원인이었음
- 최종적으로 URL에 직접 locale을 포함하는 방식 + Zustand 조합으로 해결

---

### 원격 MDX 렌더링 전략 (2025-12-02)

> 🤖 AI에 의해 git 이력 기반으로 기록됨

**내 생각/의도**

- 이전에 Cursor, Codex, Claude Code로 블로그를 시도했을 때는 프로젝트 내부 `content/` 폴더에 마크다운을 저장하고 배포하는 방식이었음
- 이번에도 동일하게 진행했으나, 글 수정 시마다 Netlify 재배포가 필요한 점이 불편했음
- 콘텐츠를 별도 리포지터리에서 관리하여 블로그 앱 재배포 없이 반영되길 원함

**AI에게 요청한 내용**

- GitHub Raw URL 기반 MDX 렌더링 요청

**AI의 판단/결과**

- blog-content 리포지터리 분리 구조 채택
- GitHub Actions로 index.json 자동 생성
- next-mdx-remote-client로 런타임 MDX 렌더링
- rehype-highlight로 코드 하이라이팅

**배운 점/개선 포인트**

- 리포지터리 분리 후, 이런 구조가 CMS(Content Management System)라는 개념으로 이미 존재한다는 것을 알게 됨
- 기존 CMS 서비스 검토 결과, Obsidian이 Git과 연동되어 있고 현재 필요한 기능 대비 과한 점이 있어 현재 구조 유지 결정 (인덱싱 양도 적음)
- 원격 파일 로딩으로 변경 후 next/mdx가 동작하지 않음을 확인. 내부 폴더 import 방식에서는 Next.js 16의 `set-mdx-components.ts`가 적용되었으나, 원격 방식에서는 동작하지 않아 next-mdx-remote-client로 전환

---

## Phase 3: 사용자 경험 개선 (2025-12-04 ~ 12-10)

### 다크 모드 구현 (2025-12-07)

> 🤖 AI에 의해 git 이력 기반으로 기록됨

**내 생각/의도**

- 주로 퇴근 후 야간에 작업하다 보니 밝은 화면으로 인한 눈 피로가 있어 다크 모드를 우선 구현
- 시스템 설정 존중 + 사용자 선택 저장 필요

**AI에게 요청한 내용**

- Tailwind dark mode + Zustand 상태 관리 요청

**AI의 판단/결과**

- Zustand로 테마 상태 관리
- localStorage에 사용자 선택 저장
- 시스템 설정 감지 (prefers-color-scheme)
- Tailwind `dark:` 클래스 활용
- 테마 토글 버튼 UI 구현

**추가 수정 사항**

- 테마 적용 로직 간소화
- 버튼 스타일링을 clsx 상수로 추출

---

### 언어 선택기 구현 (2025-12-07 ~ 12-10)

> 🤖 AI에 의해 git 이력 기반으로 기록됨

**내 생각/의도**

- 사용자가 직접 언어를 선택할 수 있는 UI 필요
- 선택한 언어가 다음 방문 시에도 유지되길 원함

**AI에게 요청한 내용**

- 언어 선택 UI 및 영속성 구현 요청

**AI의 판단/결과**

- 언어별 아이콘 (en.svg, ja.svg, ko.svg) 추가
- `NEXT_LOCALE` 쿠키로 언어 설정 영속성 구현
- Header에 언어 선택기 통합

**추가 수정 사항**

- 초기 Zustand 스토어 → 쿠키 기반으로 전환
- LocaleSync 컴포넌트 제거 및 로직 통합
- 로케일 프록시 로직 여러 차례 개선
- CDN 캐싱 방지를 위한 캐시 제어 헤더 추가

**배운 점/개선 포인트**

- 서버 사이드에서 접근 가능한 쿠키가 SSR에 유리
- 여러 번의 리팩토링 발생 - 초기 설계 시 SSR 환경을 충분히 고려해야 함

---

## Phase 4: 아키텍처 정제 (2025-12-12 ~ 현재)

### FSD 아키텍처 도입 (2025-12-10 ~ 12-12)

> 🤖 AI에 의해 git 이력 기반으로 기록됨

**내 생각/의도**

- 프로젝트 규모가 커지면서 체계적인 구조 필요
- 기능 단위로 독립적인 개발/테스트 원함

**AI에게 요청한 내용**

- FSD 아키텍처 적용 및 디렉토리 재구성 요청

**AI의 판단/결과**

- Feature-Sliced Design 레이어 구조 적용
  - app/ (라우팅)
  - features/ (비즈니스 기능)
  - entities/ (도메인 엔티티)
  - widgets/ (복합 UI)
  - shared/ (공유 리소스)
- UI 컴포넌트 디렉토리 재구성 (components → ui → components)
- MDX 엔티티를 마크다운 엔티티로 단순화

**배운 점/개선 포인트**

- 초기에 FSD를 적용하려 했으나, 각 레이어에 무엇을 넣어야 할지 몰라 시간이 오래 걸림
- 결론: 일단 `features/`에서 시작하고, 역할이 광범위해지거나 응집되면 `widgets/`, `shared/`, `entities/`로 점진적으로 분리하는 것이 효율적
- 초반 설계에 과도한 시간을 투자하지 말고, 먼저 동작하는 코드를 만든 후 리팩토링하는 것이 좋음

---

### Button 컴포넌트 구현 (2025-12-13)

> 🤖 AI에 의해 git 이력 기반으로 기록됨

**내 생각/의도**

- 재사용 가능한 기본 UI 컴포넌트 필요
- 다양한 스타일 변형 지원

**AI에게 요청한 내용**

- Button 컴포넌트 구현 요청

**AI의 판단/결과**

- 4가지 variant (primary, default, danger, link)
- 2가지 shape (fill, outline)
- 다크 모드 지원
- 접근성 고려 (focus-visible, disabled 상태)
- Storybook 스토리 작성
- Property-Based 테스트 (fast-check) 도입

**추가 수정 사항**

- Button 컴포넌트 디렉토리 구조로 재구성

**배운 점/개선 포인트**

- Property-Based 테스트로 다양한 props 조합을 자동 검증할 수 있음
- 컴포넌트 구현 시 테스트와 문서화를 함께 진행하면 효율적

---

### 의사결정 로그 문서 작성 (2025-12-13)

**내 생각/의도**

- changelog.md는 일일 변경사항만 나열되어 전체 방향성 파악이 어려움
- 의사결정의 맥락과 "왜"를 알 수 있는 문서가 필요

**AI에게 요청한 내용**

- "changelog.md를 보고 전체적으로 어떤 방향성을 가지고 왔는지 알려주는 사용자 친화적 문서가 필요합니다"

**AI의 판단/결과**

- 4개의 Phase로 나누어 기술적 의사결정과 그 이유를 정리
- 각 결정마다 "왜 이렇게 했나?" 섹션 포함
- "진화의 패턴" 섹션으로 일관된 원칙 도출

**추가 수정 사항**

- 초기 버전은 기술적 결정 위주였음
- 인간-AI 협업 과정을 추적하는 구조로 변경 요청
- 프롬프트, AI 판단, 추가 수정 사항을 기록하는 형식으로 재설계
- 파일명을 `journey.md`에서 `decision-log.md`로 변경
- git 이력 기반으로 과거 의사결정 내용 보완

**배운 점/개선 포인트**

- 처음부터 "무엇을 기록하고 싶은지" 명확히 전달했으면 한 번에 원하는 결과를 얻었을 것
- 문서의 목적(회고 vs 추적 vs 가이드)을 먼저 정의하는 것이 중요
- 파일명도 목적을 명확히 드러내야 함

---

### Giscus 댓글 시스템 추가 (2025-12-14)

> 🤖 AI에 의해 git 이력 기반으로 기록됨

**내 생각/의도**

- 블로그 포스트에 독자와 소통할 수 있는 댓글 기능 필요
- GitHub 기반으로 별도 백엔드 없이 운영 가능한 솔루션 선호

**AI에게 요청한 내용**

- Giscus 댓글 시스템 통합 요청

**AI의 판단/결과**

- @giscus/react 의존성 설치
- shared/components에 Reply 컴포넌트 생성
- 포스트 상세 페이지에 locale 지원과 함께 통합
- 다크 모드 테마 연동

**배운 점/개선 포인트**

- Giscus는 GitHub Discussions 기반으로 별도 DB 없이 댓글 관리 가능
- utterances 대비 Discussions 활용으로 더 풍부한 기능 제공
- locale prop으로 다국어 UI 지원이 간편함

---

### i18next 기반 UI 다국어 시스템 구현 (2025-12-14)

> 🤖 AI에 의해 git 이력 기반으로 기록됨

**내 생각/의도**

- 기존 URL 기반 다국어는 콘텐츠(MDX) 전환만 지원
- 네비게이션, 폼 라벨 등 UI 텍스트도 다국어화 필요
- 타입 안전성을 갖춘 번역 시스템 원함

**AI에게 요청한 내용**

- react-i18next 기반 UI 다국어 시스템 구현 요청
- Kiro spec 기능을 활용하여 요구사항 → 설계 → 구현 단계로 진행

**AI의 판단/결과**

- i18next, react-i18next 의존성 추가
- TypeScript 지원 i18n 설정 파일 생성 (한국어 fallback)
- 번역 키 타입 정의로 컴파일 타임 타입 안전성 확보
- Zod 스키마로 번역 리소스 런타임 검증
- ko, en, ja 번역 리소스 파일 생성
- fast-check 기반 번역 키 완전성/일관성 property-based 테스트 추가
- LocaleProvider에 I18nextProvider 통합
- Header, AboutBlock, ContactForm에 useTranslation 훅 적용

**추가 수정 사항**

- 초기 설계 문서 작성 후 구현 진행
- 번역 키 누락 방지를 위한 테스트 전략 추가

**배운 점/개선 포인트**

- Kiro spec을 활용한 요구사항 → 설계 → 구현 흐름이 체계적인 개발에 효과적
- Zod + fast-check 조합으로 번역 리소스의 타입 안전성과 완전성을 동시에 검증 가능
- 기존 URL 기반 locale과 i18next를 LocaleProvider에서 통합하여 일관된 언어 경험 제공

---

### Link 컴포넌트 추가 (2025-12-14)

> 🤖 AI에 의해 git 이력 기반으로 기록됨

**내 생각/의도**

- next/link를 직접 사용하면 매번 locale prefix를 수동으로 붙여야 함
- locale 처리를 자동화하는 래퍼 컴포넌트 필요

**AI에게 요청한 내용**

- locale 기반 URL 처리가 포함된 Link 컴포넌트 구현 요청

**AI의 판단/결과**

- shared/components/ui/link에 Link 컴포넌트 생성
- locale 기반 URL 자동 처리 로직 포함
- 외부 링크, 루트 경로 등 다양한 경로 타입 지원
- NextLinkProps 확장으로 타입 안전성 확보
- post-basic-card, post-simple-card에서 next/link 대신 커스텀 Link 사용

**추가 수정 사항**

- BaseLink → NextLink로 이름 변경 (명확성)
- React key 처리 개선 (post.title → post.path.join('/'))

**배운 점/개선 포인트**

- 공통 로직을 래퍼 컴포넌트로 추출하면 일관성 유지와 유지보수가 용이
- 타입 확장(NextLinkProps)으로 기존 next/link의 모든 props를 지원하면서 추가 기능 제공

---

### Typography/Code 컴포넌트 분리 (2025-12-14)

> 🤖 AI에 의해 git 이력 기반으로 기록됨

**내 생각/의도**

- setMdxComponents에 모든 마크다운 렌더링 로직이 집중되어 있음
- heading, code 등 개별 컴포넌트로 분리하여 재사용성과 테스트 용이성 확보

**AI에게 요청한 내용**

- 마크다운 컴포넌트 분리 및 리팩토링 요청

**AI의 판단/결과**

- heading 컴포넌트(h1-h5)를 Typography 컴포넌트로 분리
- 인라인/블록 코드 렌더링 로직을 Code 컴포넌트로 분리
- 코드 컴포넌트 다크모드 지원 및 스타일 개선
- setMdxComponents에서 분리된 컴포넌트 사용하도록 리팩토링
- getMarkdown에 locale 기반 URL 디코딩 처리 추가

**배운 점/개선 포인트**

- 마크다운 렌더링 컴포넌트를 entities/mdx/ui에 배치하여 FSD 구조와 일관성 유지
- 컴포넌트 분리로 개별 테스트와 Storybook 문서화가 가능해짐

---

### Steering 규칙 문서화 (2025-12-14)

> 🤖 AI에 의해 git 이력 기반으로 기록됨

**내 생각/의도**

- AI와 협업 시 일관된 커밋 메시지 형식 유지 필요
- 과거 시행착오를 문서화하여 같은 실수 반복 방지

**AI에게 요청한 내용**

- 커밋 메시지 규칙 및 시행착오 문서화 요청

**AI의 판단/결과**

- `.kiro/steering/commit.md` 파일 추가하여 커밋 메시지 규칙 정의
- Type, Scope, 원칙 등 커밋 메시지 작성 가이드 문서화
- product.md, structure.md, tech.md에 과거 시행착오 섹션 추가
- ARCHITECTURE.md에 Kiro Steering 규칙 섹션 추가

**배운 점/개선 포인트**

- Steering 파일을 통해 AI가 프로젝트 컨텍스트를 이해하고 일관된 결과물 생성
- 시행착오를 문서화하면 AI가 같은 실수를 반복하지 않음
- 문서화는 미래의 나와 AI 모두를 위한 투자

---

## 협업 패턴 분석

> 이 섹션은 기록이 쌓이면 패턴을 분석하여 업데이트합니다.

### 잘 작동한 패턴

- **Kiro spec 활용**: 요구사항 → 설계 → 구현 단계로 체계적 진행 (i18next 구현에서 효과적)
- **Zod + fast-check 조합**: 타입 안전성과 테스트를 동시에 확보
- **Steering 문서화**: 시행착오를 기록하여 AI가 같은 실수 반복 방지
- **래퍼 컴포넌트 패턴**: Link 컴포넌트처럼 공통 로직을 추출하여 일관성 유지

### 개선이 필요한 패턴

- 언어 선택기: Zustand → 쿠키 전환 등 여러 번 리팩토링 발생
- Contact 폼: 여러 번 revert 후 재구현
- 디렉토리 구조: components → ui → components 등 변경 반복
- Button export 방식: named → default export 전환으로 import 문 일괄 수정 필요

### 효과적인 프롬프트 예시

- **체계적 구현**: "Kiro spec을 활용하여 요구사항 → 설계 → 구현 단계로 진행해주세요"
- **회고 요청**: "지금까지 작업한 내용에 대해서 회고하고 decision-log.md에 기록하자"

---

## 관련 문서

- [변경 로그](./changelog.md) - 상세 변경 이력
- [할 일 목록](./todo.md) - 남은 작업
- [구현 계획](./implementation-plan.md) - 기술 스택 및 진행 상황

---

> 📖 전체 문서 목록은 [문서 홈](../README.md)을 참고하세요.
